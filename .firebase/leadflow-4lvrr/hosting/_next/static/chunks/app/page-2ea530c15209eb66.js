(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{37648:(e,t,l)=>{"use strict";l.d(t,{A:()=>r});let r=(0,l(40157).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},40590:(e,t,l)=>{Promise.resolve().then(l.bind(l,70636))},50286:(e,t,l)=>{"use strict";l.d(t,{A:()=>r});let r=(0,l(40157).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},56104:(e,t,l)=>{"use strict";l.d(t,{EF:()=>p,IG:()=>d,V$:()=>m,db:()=>c,j2:()=>u,yA:()=>o});var r=l(23915),a=l(93004),i=l(35317),s=l(90858),n=l(81427);let o=(0,r.Dk)().length?(0,r.Sx)():(0,r.Wp)({apiKey:"AIzaSyBc3jmFE6dRXBApmWD9Jg2PO86suqGgaZw",authDomain:"leadflow-4lvrr.firebaseapp.com",projectId:"leadflow-4lvrr",storageBucket:"leadflow-4lvrr.firebasestorage.app",messagingSenderId:"13877630896",appId:"1:13877630896:web:ab7d2717024960ec36e875",measurementId:"G-KDEF2C21SH"}),u=(0,a.xI)(o),c=(0,i.aU)(o),d=(0,s.c7)(o),g=(0,n.Uz)(o),p=(0,n.Qg)(g,"acceptJob"),m=(0,n.Qg)(g,"inviteUser");(0,n.Qg)(g,"updateAdminRoles"),(0,n.Qg)(g,"getTeamStats"),(0,n.Qg)(g,"getDetailedAnalytics"),(0,n.Qg)(g,"generateAnalyticsReport")},70636:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>p});var r=l(95155),a=l(12115),i=l(35695),s=l(98030),n=l(50172),o=l(40157);let u=(0,o.A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);var c=l(50286),d=l(81203),g=l(37648);function p(){let{user:e,loading:t}=(0,s.A)(),l=(0,i.useRouter)();return(0,a.useEffect)(()=>{t||(e?l.replace("/dashboard"):l.replace("/login"))},[e,t,l]),(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-background",children:(0,r.jsx)(n.A,{className:"h-12 w-12 animate-spin text-primary"})})}l(80659),(0,o.A)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),c.A,d.A,g.A},80659:(e,t,l)=>{"use strict";l.d(t,{A:()=>r});let r=(0,l(40157).A)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},81203:(e,t,l)=>{"use strict";l.d(t,{A:()=>r});let r=(0,l(40157).A)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},98030:(e,t,l)=>{"use strict";l.d(t,{A:()=>g,AuthProvider:()=>d});var r=l(95155),a=l(93004),i=l(35317),s=l(35695),n=l(12115),o=l(56104),u=l(50172);let c=(0,n.createContext)(void 0),d=e=>{let{children:t}=e,[l,d]=(0,n.useState)(null),[g,p]=(0,n.useState)(null),[m,y]=(0,n.useState)(!0),[h,v]=(0,n.useState)(!1),f=(0,s.useRouter)(),k=(0,s.usePathname)(),x=(0,n.useRef)({isNavigating:!1});(0,n.useEffect)(()=>{console.log("\uD83D\uDD25 Setting up Firebase auth listener");let e=(0,a.hg)(o.j2,async e=>{if(console.log("\uD83D\uDD25 Firebase auth state changed:",!!e,"uid:",null==e?void 0:e.uid),(null==l?void 0:l.uid)===(null==e?void 0:e.uid)&&h)return void console.log("\uD83D\uDD04 Same user, skipping update");d(e),v(!0),!e&&(p(null),y(!1),"/login"===k||x.current.isNavigating||(x.current.isNavigating=!0,console.log("\uD83D\uDEAA Redirecting to login"),f.replace("/login"),setTimeout(()=>{x.current.isNavigating=!1},1e3)))});return()=>{console.log("\uD83D\uDD25 Cleaning up Firebase auth listener"),e()}},[]),(0,n.useEffect)(()=>{let e;if(l&&h){console.log("\uD83D\uDC64 Setting up user document listener for:",l.uid);let t=(0,i.doc)(o.db,"users",l.uid);e=(0,i.aQ)(t,async e=>{if(console.log("\uD83D\uDCC4 User document snapshot received, exists:",e.exists()),e.exists()){let t={uid:l.uid,...e.data()};p(t),y(!1),console.log("✅ User data loaded:",t.email,t.role),"/login"!==k||x.current.isNavigating||(x.current.isNavigating=!0,console.log("\uD83C\uDFE0 Redirecting to dashboard"),f.replace("/dashboard"),setTimeout(()=>{x.current.isNavigating=!1},1e3))}else{console.log("\uD83D\uDCDD Creating default user document");let e={uid:l.uid,email:l.email||"",displayName:l.displayName||"",role:"setter",teamId:"default",avatarUrl:l.photoURL||null,phoneNumber:l.phoneNumber||null,status:"On Duty",createdAt:new Date().toISOString()};try{await (0,i.setDoc)(t,e),p(e),y(!1),console.log("✅ Default user document created")}catch(e){console.error("❌ Failed to create user document:",e),p(null),y(!1)}}},e=>{console.error("❌ User document listener error:",e),p(null),y(!1)})}else!l&&h&&(p(null),y(!1));return()=>{e&&(console.log("\uD83E\uDDF9 Cleaning up user document listener"),e())}},[l,h,k,f]);let A=async()=>{console.log("\uD83D\uDC4B Logging out"),x.current.isNavigating=!0,y(!0);try{await (0,a.CI)(o.j2),p(null),d(null),f.replace("/login")}catch(e){console.error("❌ Logout error:",e)}finally{y(!1),setTimeout(()=>{x.current.isNavigating=!1},1e3)}};if(m&&!h)return(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-background",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,r.jsx)(u.A,{className:"h-12 w-12 animate-spin text-primary"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading..."})]})});let b={firebaseUser:l,user:g,loading:m,teamId:(null==g?void 0:g.teamId)||null,role:(null==g?void 0:g.role)||null,logout:A};return(0,r.jsx)(c.Provider,{value:b,children:t})},g=()=>{let e=(0,n.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,3644,4763,8441,1684,7358],()=>t(40590)),_N_E=e.O()}]);