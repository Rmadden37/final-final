(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{52728:()=>{},56104:(e,t,l)=>{"use strict";l.d(t,{EF:()=>m,IG:()=>d,V$:()=>p,db:()=>c,j2:()=>u,yA:()=>o});var r=l(23915),a=l(93004),n=l(35317),s=l(90858),i=l(81427);let o=(0,r.Dk)().length?(0,r.Sx)():(0,r.Wp)({apiKey:"AIzaSyBc3jmFE6dRXBApmWD9Jg2PO86suqGgaZw",authDomain:"leadflow-4lvrr.firebaseapp.com",projectId:"leadflow-4lvrr",storageBucket:"leadflow-4lvrr.firebasestorage.app",messagingSenderId:"13877630896",appId:"1:13877630896:web:ab7d2717024960ec36e875",measurementId:"G-KDEF2C21SH"}),u=(0,a.xI)(o),c=(0,n.aU)(o),d=(0,s.c7)(o),g=(0,i.Uz)(o),m=(0,i.Qg)(g,"acceptJob"),p=(0,i.Qg)(g,"inviteUser");(0,i.Qg)(g,"updateAdminRoles"),(0,i.Qg)(g,"getTeamStats"),(0,i.Qg)(g,"getDetailedAnalytics"),(0,i.Qg)(g,"generateAnalyticsReport")},56615:(e,t,l)=>{Promise.resolve().then(l.t.bind(l,78346,23)),Promise.resolve().then(l.t.bind(l,52728,23)),Promise.resolve().then(l.bind(l,98030))},78346:e=>{e.exports={style:{fontFamily:"'Inter', 'Inter Fallback'",fontStyle:"normal"},className:"__className_e8ce0c"}},98030:(e,t,l)=>{"use strict";l.d(t,{A:()=>g,AuthProvider:()=>d});var r=l(95155),a=l(93004),n=l(35317),s=l(35695),i=l(12115),o=l(56104),u=l(50172);let c=(0,i.createContext)(void 0),d=e=>{let{children:t}=e,[l,d]=(0,i.useState)(null),[g,m]=(0,i.useState)(null),[p,v]=(0,i.useState)(!0),[h,f]=(0,i.useState)(!1),b=(0,s.useRouter)(),N=(0,s.usePathname)(),x=(0,i.useRef)({isNavigating:!1});(0,i.useEffect)(()=>{console.log("\uD83D\uDD25 Setting up Firebase auth listener");let e=(0,a.hg)(o.j2,async e=>{if(console.log("\uD83D\uDD25 Firebase auth state changed:",!!e,"uid:",null==e?void 0:e.uid),(null==l?void 0:l.uid)===(null==e?void 0:e.uid)&&h)return void console.log("\uD83D\uDD04 Same user, skipping update");d(e),f(!0),!e&&(m(null),v(!1),"/login"===N||x.current.isNavigating||(x.current.isNavigating=!0,console.log("\uD83D\uDEAA Redirecting to login"),b.replace("/login"),setTimeout(()=>{x.current.isNavigating=!1},1e3)))});return()=>{console.log("\uD83D\uDD25 Cleaning up Firebase auth listener"),e()}},[]),(0,i.useEffect)(()=>{let e;if(l&&h){console.log("\uD83D\uDC64 Setting up user document listener for:",l.uid);let t=(0,n.doc)(o.db,"users",l.uid);e=(0,n.aQ)(t,async e=>{if(console.log("\uD83D\uDCC4 User document snapshot received, exists:",e.exists()),e.exists()){let t={uid:l.uid,...e.data()};m(t),v(!1),console.log("✅ User data loaded:",t.email,t.role),"/login"!==N||x.current.isNavigating||(x.current.isNavigating=!0,console.log("\uD83C\uDFE0 Redirecting to dashboard"),b.replace("/dashboard"),setTimeout(()=>{x.current.isNavigating=!1},1e3))}else{console.log("\uD83D\uDCDD Creating default user document");let e={uid:l.uid,email:l.email||"",displayName:l.displayName||"",role:"setter",teamId:"default",avatarUrl:l.photoURL||null,phoneNumber:l.phoneNumber||null,status:"On Duty",createdAt:new Date().toISOString()};try{await (0,n.setDoc)(t,e),m(e),v(!1),console.log("✅ Default user document created")}catch(e){console.error("❌ Failed to create user document:",e),m(null),v(!1)}}},e=>{console.error("❌ User document listener error:",e),m(null),v(!1)})}else!l&&h&&(m(null),v(!1));return()=>{e&&(console.log("\uD83E\uDDF9 Cleaning up user document listener"),e())}},[l,h,N,b]);let y=async()=>{console.log("\uD83D\uDC4B Logging out"),x.current.isNavigating=!0,v(!0);try{await (0,a.CI)(o.j2),m(null),d(null),b.replace("/login")}catch(e){console.error("❌ Logout error:",e)}finally{v(!1),setTimeout(()=>{x.current.isNavigating=!1},1e3)}};if(p&&!h)return(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-background",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,r.jsx)(u.A,{className:"h-12 w-12 animate-spin text-primary"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading..."})]})});let S={firebaseUser:l,user:g,loading:p,teamId:(null==g?void 0:g.teamId)||null,role:(null==g?void 0:g.role)||null,logout:y};return(0,r.jsx)(c.Provider,{value:S,children:t})},g=()=>{let e=(0,i.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[2191,7690,2992,3644,4763,8441,1684,7358],()=>t(56615)),_N_E=e.O()}]);