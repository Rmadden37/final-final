(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[399],{17759:(e,t,s)=>{"use strict";s.d(t,{C5:()=>v,MJ:()=>h,Rr:()=>g,eI:()=>p,lR:()=>x,lV:()=>d,zB:()=>u});var a=s(95155),i=s(12115),r=s(99708),l=s(62177),n=s(59434),o=s(85057);let d=l.Op,c=i.createContext({}),u=e=>{let{...t}=e;return(0,a.jsx)(c.Provider,{value:{name:t.name},children:(0,a.jsx)(l.xI,{...t})})},m=()=>{let e=i.useContext(c),t=i.useContext(f),{getFieldState:s,formState:a}=(0,l.xW)(),r=s(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:n}=t;return{id:n,name:e.name,formItemId:"".concat(n,"-form-item"),formDescriptionId:"".concat(n,"-form-item-description"),formMessageId:"".concat(n,"-form-item-message"),...r}},f=i.createContext({}),p=i.forwardRef((e,t)=>{let{className:s,...r}=e,l=i.useId();return(0,a.jsx)(f.Provider,{value:{id:l},children:(0,a.jsx)("div",{ref:t,className:(0,n.cn)("space-y-2",s),...r})})});p.displayName="FormItem";let x=i.forwardRef((e,t)=>{let{className:s,...i}=e,{error:r,formItemId:l}=m();return(0,a.jsx)(o.J,{ref:t,className:(0,n.cn)(r&&"text-destructive",s),htmlFor:l,...i})});x.displayName="FormLabel";let h=i.forwardRef((e,t)=>{let{...s}=e,{error:i,formItemId:l,formDescriptionId:n,formMessageId:o}=m();return(0,a.jsx)(r.DX,{ref:t,id:l,"aria-describedby":i?"".concat(n," ").concat(o):"".concat(n),"aria-invalid":!!i,...s})});h.displayName="FormControl";let g=i.forwardRef((e,t)=>{let{className:s,...i}=e,{formDescriptionId:r}=m();return(0,a.jsx)("p",{ref:t,id:r,className:(0,n.cn)("text-sm text-muted-foreground",s),...i})});g.displayName="FormDescription";let v=i.forwardRef((e,t)=>{var s;let{className:i,children:r,...l}=e,{error:o,formMessageId:d}=m(),c=o?String(null!=(s=null==o?void 0:o.message)?s:""):r;return c?(0,a.jsx)("p",{ref:t,id:d,className:(0,n.cn)("text-sm font-medium text-destructive",i),...l,children:c}):null});v.displayName="FormMessage"},51677:(e,t,s)=>{Promise.resolve().then(s.bind(s,93188))},62523:(e,t,s)=>{"use strict";s.d(t,{p:()=>l});var a=s(95155),i=s(12115),r=s(59434);let l=i.forwardRef((e,t)=>{let{className:s,type:i,...l}=e;return(0,a.jsx)("input",{type:i,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...l})});l.displayName="Input"},66695:(e,t,s)=>{"use strict";s.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>l,aR:()=>n,wL:()=>u});var a=s(95155),i=s(12115),r=s(59434);let l=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)("div",{ref:t,"data-card":"true",className:(0,r.cn)("rounded-2xl overflow-hidden border border-slate-200 bg-white text-card-foreground","shadow-lg shadow-slate-200/50 hover:shadow-xl hover:shadow-slate-300/50","transition-all duration-200 ease-in-out","mobile:rounded-xl mobile:mx-2 mobile:shadow-md","mobile:border-slate-300/50",s),...i})});l.displayName="Card";let n=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6","mobile:p-4 mobile:space-y-1",s),...i})});n.displayName="CardHeader";let o=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)("h3",{ref:t,className:(0,r.cn)("text-3xl font-bold font-headline leading-tight tracking-tight text-center","mobile:text-xl mobile:leading-snug","tablet:text-2xl",s),...i})});o.displayName="CardTitle";let d=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)("p",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground text-center","mobile:text-xs mobile:leading-relaxed",s),...i})});d.displayName="CardDescription";let c=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",s),...i})});c.displayName="CardContent";let u=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",s),...i})});u.displayName="CardFooter"},85057:(e,t,s)=>{"use strict";s.d(t,{J:()=>d});var a=s(95155),i=s(12115),r=s(40968),l=s(74466),n=s(59434);let o=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)(r.b,{ref:t,className:(0,n.cn)(o(),s),...i})});d.displayName=r.b.displayName},91394:(e,t,s)=>{"use strict";s.d(t,{BK:()=>o,eu:()=>n,q5:()=>d});var a=s(95155),i=s(12115),r=s(54011),l=s(59434);let n=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)(r.bL,{ref:t,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...i})});n.displayName=r.bL.displayName;let o=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)(r._V,{ref:t,className:(0,l.cn)("aspect-square h-full w-full",s),...i})});o.displayName=r._V.displayName;let d=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)(r.H4,{ref:t,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...i})});d.displayName=r.H4.displayName},93188:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>$});var a=s(95155),i=s(12115),r=s(98030),l=s(30285),n=s(62523),o=s(66695),d=s(17759),c=s(62177),u=s(90221),m=s(71153),f=s(56104),p=s(93004),x=s(35317),h=s(90858),g=s(87481),v=s(50172),N=s(91721),w=s(67933),j=s(19637),y=s(76570),b=s(50286),S=s(15222),C=s(93576),A=s(36931),P=s(91394),k=s(54165),R=s(83833);s(54534);var I=s(74466),D=s(59434);let E=(0,I.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),F=i.forwardRef((e,t)=>{let{className:s,variant:i,...r}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,D.cn)(E({variant:i}),s),...r})});F.displayName="Alert",i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)("h5",{ref:t,className:(0,D.cn)("mb-1 font-medium leading-none tracking-tight",s),...i})}).displayName="AlertTitle";let U=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,D.cn)("text-sm [&_p]:leading-relaxed",s),...i})});U.displayName="AlertDescription";var W=s(3819),T=s(95633),B=s(10518),O=s(25318),M=s(31949),_=s(20996);let L=null;L=(0,_.dG)(f.yA);let q=async()=>{try{if(!L)return console.log("Messaging not supported"),null;let e=await Notification.requestPermission();if("granted"!==e)return console.log("Notification permission denied"),null;{console.log("Notification permission granted");let e=await (0,_.gf)(L,{vapidKey:"BFkIa_CVwkOy5w_TZBDzrc9icj9KjGexDAt84BVTVK0YtRZ1LGkS4NWmqo4Hnj6RvWX0hOQyXeEveSTSsC6GUqo"});if(e)return console.log("FCM token:",e),e;return console.log("No registration token available"),null}}catch(e){return console.error("Error getting notification permission:",e),null}},H=()=>new Promise(e=>{L&&(0,_.xD)(L,t=>{var s,a;if(console.log("Message received. ",t),(null==(s=t.data)?void 0:s.type)!=="lead_assigned")return void console.log("Notification type '".concat(null==(a=t.data)?void 0:a.type,"' blocked - only lead_assigned notifications allowed"));e(t)})}),Y=async()=>{if("serviceWorker"in navigator)try{let e=await navigator.serviceWorker.register("/firebase-messaging-sw.js");return console.log("Service Worker registered successfully:",e),e}catch(e){console.error("Service Worker registration failed:",e)}return null};function z(){return/iPad|iPhone|iPod/.test(navigator.userAgent)}function V(){let[e,t]=(0,i.useState)("default"),[s,n]=(0,i.useState)(!1),[d,c]=(0,i.useState)(null),{toast:u}=(0,g.dj)(),{user:m}=(0,r.A)(),[p,h]=(0,i.useState)({isIOS:!1,isPWA:!1,isSupported:!0,needsInstallation:!1});(0,i.useEffect)(()=>{"Notification"in window&&t(Notification.permission);let e=z(),s=window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone;return h({isIOS:e,isPWA:s,isSupported:function(){if(!z())return!0;let e=navigator.userAgent.match(/OS (\d+)_(\d+)/);if(!e)return!1;let t=parseInt(e[1]),s=parseInt(e[2]);return t>16||16===t&&s>=4}(),needsInstallation:e&&!s}),Y(),H().then(e=>{var t,s;console.log("Foreground message received:",e),u({title:(null==(t=e.notification)?void 0:t.title)||"New Notification",description:(null==(s=e.notification)?void 0:s.body)||"You have a new notification"})}).catch(console.error),()=>{}},[u]);let v=async()=>{n(!0);try{if(p.isIOS&&!p.isSupported)return void u({title:"❌ iOS Version Not Supported",description:"iOS 16.4+ is required for push notifications. Please update your device.",variant:"destructive"});if(p.needsInstallation)return void u({title:"\uD83D\uDCF1 Installation Required",description:"Add this app to your home screen first to enable notifications on iOS.",variant:"destructive"});let e=await q();e?(c(e),t("granted"),(null==m?void 0:m.uid)&&await (0,x.setDoc)((0,x.doc)(f.db,"userTokens",m.uid),{fcmToken:e,userId:m.uid,context:p.isPWA?"pwa":"browser",platform:p.isIOS?"ios":"other",userAgent:navigator.userAgent,updatedAt:new Date,enabled:!0,...p.isPWA&&{pwaInstallDate:new Date}},{merge:!0}),u({title:"✅ Notifications Enabled!",description:p.isPWA?"You'll now receive push notifications in your home screen app.":"You'll now receive push notifications for new leads and appointments."})):u({title:"❌ Permission Denied",description:"Please enable notifications in your browser settings to receive alerts.",variant:"destructive"})}catch(e){console.error("Error enabling notifications:",e),u({title:"❌ Error",description:"Failed to enable notifications. Please try again.",variant:"destructive"})}finally{n(!1)}},N=async()=>{n(!0);try{(null==m?void 0:m.uid)&&await (0,x.setDoc)((0,x.doc)(f.db,"userTokens",m.uid),{enabled:!1,disabledAt:new Date},{merge:!0}),t("denied"),c(null),u({title:"\uD83D\uDD15 Notifications Disabled",description:"You will no longer receive push notifications."})}catch(e){console.error("Error disabling notifications:",e),u({title:"❌ Error",description:"Failed to disable notifications. Please try again.",variant:"destructive"})}finally{n(!1)}};return(0,a.jsx)("div",{className:"w-full max-w-md space-y-4",children:(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsxs)(o.ZB,{className:"flex items-center gap-2",children:["granted"===e?(0,a.jsx)(A.A,{className:"h-5 w-5 text-green-500"}):(0,a.jsx)(W.A,{className:"h-5 w-5 text-gray-500"}),"Push Notifications"]}),(0,a.jsx)(o.BT,{children:"Get notified about new leads, appointments, and important updates"})]}),(0,a.jsxs)(o.Wu,{className:"space-y-4",children:[p.isIOS&&(0,a.jsxs)(F,{className:p.needsInstallation?"border-yellow-200 bg-yellow-50":"border-blue-200 bg-blue-50",children:[(0,a.jsx)(T.A,{className:"h-4 w-4"}),(0,a.jsx)(U,{children:p.needsInstallation?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("strong",{children:"iOS Installation Required:"})," Add this app to your home screen to enable notifications.",(0,a.jsx)("br",{}),(0,a.jsx)("small",{children:'Tap the Share button → "Add to Home Screen"'})]}):p.isPWA?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("strong",{children:"iOS PWA Mode:"})," Perfect! Notifications will work in your home screen app."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("strong",{children:"iOS Browser Mode:"})," Limited notification support."]})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-sm",children:["Status:",(0,a.jsx)("span",{className:"ml-1 font-medium ".concat("granted"===e?"text-green-600":"denied"===e?"text-red-600":"text-yellow-600"),children:"granted"===e?"Enabled":"denied"===e?"Disabled":"Not Set"})]}),"granted"===e&&(0,a.jsx)(B.A,{className:"h-4 w-4 text-green-500"}),"denied"===e&&(0,a.jsx)(O.A,{className:"h-4 w-4 text-red-500"})]}),"granted"!==e?(0,a.jsx)(l.$,{onClick:v,disabled:s||p.isIOS&&!p.isSupported,className:"w-full",children:s?"Enabling...":"Enable Notifications"}):(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.$,{onClick:()=>{"Notification"in window&&"granted"===Notification.permission&&(new Notification("\uD83D\uDE80 Test Notification",{body:"Push notifications are working perfectly!",icon:"/icon-192x192.png",badge:"/icon-192x192.png",tag:"test-notification"}),u({title:"\uD83D\uDCF1 Test Sent!",description:"Check your device for the test notification."}))},variant:"outline",className:"w-full",children:"Send Test Notification"}),(0,a.jsx)(l.$,{onClick:N,disabled:s,variant:"destructive",className:"w-full",children:s?"Disabling...":"Disable Notifications"})]}),d&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[(0,a.jsx)("p",{children:"✅ Connected to push service"}),p.isPWA&&(0,a.jsx)("p",{children:"\uD83D\uDCF1 PWA mode active"})]}),p.needsInstallation&&(0,a.jsxs)(F,{children:[(0,a.jsx)(M.A,{className:"h-4 w-4"}),(0,a.jsxs)(U,{children:[(0,a.jsx)("strong",{children:"To enable notifications on iPhone/iPad:"}),(0,a.jsxs)("ol",{className:"list-decimal list-inside mt-2 space-y-1 text-xs",children:[(0,a.jsx)("li",{children:"Tap the Share button (□↗) in Safari"}),(0,a.jsx)("li",{children:'Scroll down and tap "Add to Home Screen"'}),(0,a.jsx)("li",{children:'Tap "Add" to install the app'}),(0,a.jsx)("li",{children:"Open the app from your home screen"}),(0,a.jsx)("li",{children:"Enable notifications when prompted"})]})]})]})]})]})})}let Z=m.Ik({displayName:m.Yj().min(2,{message:"Display name must be at least 2 characters."}).max(50,{message:"Display name cannot exceed 50 characters."})});async function G(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=t.getContext("2d");if(!r)throw Error("No 2d context");let l=e.naturalWidth/e.width,n=e.naturalHeight/e.height,o=window.devicePixelRatio;t.width=Math.floor(s.width*l*o),t.height=Math.floor(s.height*n*o),r.scale(o,o),r.imageSmoothingQuality="high";let d=s.x*l,c=s.y*n,u=i*Math.PI/180,m=e.naturalWidth/2,f=e.naturalHeight/2;r.save(),r.translate(-d,-c),r.translate(m,f),r.rotate(u),r.scale(a,a),r.translate(-m,-f),r.drawImage(e,0,0,e.naturalWidth,e.naturalHeight,0,0,e.naturalWidth,e.naturalHeight),r.restore()}function $(){var e,t;let{user:s,firebaseUser:m,loading:I,logout:D}=(0,r.A)(),{toast:E}=(0,g.dj)(),[F,U]=(0,i.useState)(!1),[W,T]=(0,i.useState)(!1),[B,O]=(0,i.useState)(!1),[M,_]=(0,i.useState)(""),L=(0,i.useRef)(null),q=(0,i.useRef)(null),[H,Y]=(0,i.useState)(),[z,$]=(0,i.useState)(),[K,J]=(0,i.useState)(!1),X=(0,c.mN)({resolver:(0,u.u)(Z),defaultValues:{displayName:""}});(0,i.useEffect)(()=>{(null==s?void 0:s.displayName)&&X.reset({displayName:s.displayName})},[s,X]);let Q=async e=>{if(!m||!s)return void E({title:"Error",description:"User not found.",variant:"destructive"});U(!0);try{await (0,p.r7)(m,{displayName:e.displayName});let t=(0,x.doc)(f.db,"users",s.uid);if(await (0,x.updateDoc)(t,{displayName:e.displayName}),"closer"===s.role){let t=(0,x.doc)(f.db,"closers",s.uid);(await (0,x.getDoc)(t)).exists()&&await (0,x.updateDoc)(t,{name:e.displayName})}E({title:"Profile Updated",description:"Your display name has been successfully updated."}),X.reset({displayName:e.displayName})}catch(e){E({title:"Update Failed",description:"Could not update your profile. Please try again.",variant:"destructive"})}finally{U(!1)}},ee=async()=>{if(!(null==s?void 0:s.email))return void E({title:"Error",description:"Email address not found.",variant:"destructive"});T(!0);try{await (0,p.J1)(f.j2,s.email),E({title:"Password Reset Email Sent",description:"Check your inbox for a password reset link. You will be logged out."}),setTimeout(async()=>{await D()},3e3)}catch(e){E({title:"Request Failed",description:"Could not send password reset email. Please try again.",variant:"destructive"})}finally{T(!1)}};(0,i.useEffect)(()=>{(null==z?void 0:z.width)&&(null==z?void 0:z.height)&&L.current&&q.current&&G(L.current,q.current,z)},[z]);let et=async()=>{if(!z||!q.current||!s)return void E({title:"Error",description:"Crop details or user not available.",variant:"destructive"});console.log("Starting upload process..."),console.log("User:",s.uid),console.log("Completed crop:",z),J(!0);let e=q.current;console.log("Creating blob from canvas..."),e.toBlob(async e=>{if(!e){console.error("Failed to create blob from canvas"),E({title:"Error",description:"Could not create image blob.",variant:"destructive"}),J(!1);return}console.log("Blob created successfully:",e.size,"bytes");let t=(0,h.KR)(f.IG,"profile_pictures/".concat(s.uid,"/profile.png"));console.log("Storage ref created:",t.fullPath);try{console.log("Starting Firebase upload...");let a=(0,h.bp)(t,e,{contentType:"image/png"});await new Promise((e,t)=>{a.on("state_changed",e=>{let t=e.bytesTransferred/e.totalBytes*100;console.log("Upload progress:",Math.round(t)+"%")},e=>{console.error("Upload error:",e),console.error("Error code:",e.code),console.error("Error message:",e.message),t(e)},()=>{console.log("Upload completed successfully"),e(a.snapshot)})}),console.log("Getting download URL...");let i=await (0,h.qk)(t);console.log("Download URL obtained:",i),console.log("Updating user document...");let r=(0,x.doc)(f.db,"users",s.uid);if(await (0,x.updateDoc)(r,{avatarUrl:i}),"closer"===s.role){console.log("Updating closer document...");let e=(0,x.doc)(f.db,"closers",s.uid);(await (0,x.getDoc)(e)).exists()&&await (0,x.updateDoc)(e,{avatarUrl:i})}console.log("Upload process completed successfully"),E({title:"Profile Photo Updated",description:"Your new photo is now active."}),O(!1),_("")}catch(e){console.error("Profile photo upload error:",e),console.error("Error details:",{code:null==e?void 0:e.code,message:null==e?void 0:e.message,stack:null==e?void 0:e.stack}),E({title:"Upload Failed",description:(null==e?void 0:e.message)||"Could not upload profile picture. Please try again.",variant:"destructive"})}finally{J(!1)}},"image/png",.95)};return I?(0,a.jsx)("div",{className:"flex min-h-[calc(100vh-var(--header-height,4rem))] items-center justify-center",children:(0,a.jsx)(v.A,{className:"h-12 w-12 animate-spin text-primary"})}):s?(0,a.jsxs)("div",{className:"container mx-auto py-8 max-w-3xl space-y-8",children:[" ",(0,a.jsxs)(o.Zp,{className:"shadow-xl",children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsxs)(o.ZB,{className:"text-3xl font-bold font-headline flex items-center justify-center",children:[(0,a.jsx)(N.A,{className:"mr-3 h-8 w-8 text-primary"}),"User Profile"]}),(0,a.jsx)(o.BT,{className:"text-center",children:"Manage your personal information and account settings."})]}),(0,a.jsxs)(o.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,a.jsxs)(P.eu,{className:"h-24 w-24 border-2 border-primary shadow-md",children:[(0,a.jsx)(P.BK,{src:s.avatarUrl||void 0,alt:s.displayName||s.email||"User"}),(0,a.jsx)(P.q5,{className:"text-3xl",children:s.displayName?s.displayName.substring(0,2).toUpperCase():s.email?s.email.substring(0,2).toUpperCase():(0,a.jsx)(N.A,{size:40})})]}),(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsxs)(l.$,{variant:"outline",size:"sm",onClick:()=>{var e;return null==(e=document.getElementById("photoInput"))?void 0:e.click()},disabled:K,children:[(0,a.jsx)(w.A,{className:"mr-2 h-4 w-4"}),K?"Uploading...":"Change Photo"]}),(0,a.jsx)("input",{type:"file",id:"photoInput",accept:"image/*",onChange:function(e){if(e.target.files&&e.target.files.length>0){Y(void 0);let t=new FileReader;t.addEventListener("load",()=>{var e;return _((null==(e=t.result)?void 0:e.toString())||"")}),t.readAsDataURL(e.target.files[0]),O(!0)}},className:"hidden"})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"For best results, upload a 1x1 (square) image."})]}),(0,a.jsxs)("div",{className:"space-y-2 pt-4 border-t",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(j.A,{className:"mr-2 h-5 w-5 text-muted-foreground"}),(0,a.jsx)("span",{className:"font-medium",children:"Email:"}),(0,a.jsx)("span",{className:"ml-2 text-muted-foreground",children:s.email})]}),(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(y.A,{className:"mr-2 h-5 w-5 text-muted-foreground"}),(0,a.jsx)("span",{className:"font-medium",children:"Role:"}),(0,a.jsx)("span",{className:"ml-2 text-muted-foreground capitalize",children:s.role})]}),s.teamId&&(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(b.A,{className:"mr-2 h-5 w-5 text-muted-foreground"}),(0,a.jsx)("span",{className:"font-medium",children:"Team ID:"}),(0,a.jsx)("span",{className:"ml-2 text-muted-foreground",children:s.teamId})]})]}),(0,a.jsx)(d.lV,{...X,children:(0,a.jsxs)("form",{onSubmit:X.handleSubmit(Q),className:"space-y-4",children:[(0,a.jsx)(d.zB,{control:X.control,name:"displayName",render:e=>{let{field:t}=e;return(0,a.jsxs)(d.eI,{children:[(0,a.jsxs)(d.lR,{className:"flex items-center",children:[(0,a.jsx)(S.A,{className:"mr-2 h-4 w-4"}),"Display Name"]}),(0,a.jsx)(d.MJ,{children:(0,a.jsx)(n.p,{placeholder:"Your Name",...t})}),(0,a.jsx)(d.C5,{})]})}}),(0,a.jsx)(l.$,{type:"submit",disabled:F,className:"w-full sm:w-auto",children:F?(0,a.jsx)(v.A,{className:"mr-2 h-5 w-5 animate-spin"}):"Save Changes"})]})})]}),(0,a.jsxs)(o.wL,{className:"flex-col items-start space-y-4 border-t pt-6 mt-6",children:[(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold font-headline flex items-center justify-center",children:[(0,a.jsx)(C.A,{className:"mr-2 h-6 w-6 text-primary"}),"Password Reset"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1 text-center",children:"If you need to reset your password, click the button below. A reset link will be sent to your email address."})]}),(0,a.jsx)(l.$,{variant:"outline",onClick:ee,disabled:W,className:"w-full sm:w-auto self-center",children:W?(0,a.jsx)(v.A,{className:"mr-2 h-5 w-5 animate-spin"}):"Send Password Reset Email"})]})]}),(0,a.jsxs)(o.Zp,{className:"shadow-xl",children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsxs)(o.ZB,{className:"text-2xl font-bold font-headline flex items-center justify-center",children:[(0,a.jsx)(A.A,{className:"mr-3 h-7 w-7 text-primary"}),"Push Notifications"]}),(0,a.jsx)(o.BT,{className:"text-center",children:"Get instant notifications for new leads, appointments, and important updates"})]}),(0,a.jsx)(o.Wu,{className:"flex justify-center",children:(0,a.jsx)(V,{})})]}),(0,a.jsx)(k.lG,{open:B,onOpenChange:e=>{e?O(!0):(O(!1),_(""))},children:(0,a.jsxs)(k.Cf,{className:"sm:max-w-md",children:[(0,a.jsxs)(k.c7,{children:[(0,a.jsx)(k.L3,{children:"Crop Your Photo"}),(0,a.jsx)(k.rr,{children:"Adjust the selection to crop your photo. A 1x1 aspect ratio is maintained."})]}),M&&(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,a.jsx)(R.Ay,{crop:H,onChange:(e,t)=>Y(t),onComplete:e=>$(e),aspect:1,circularCrop:!0,minWidth:100,minHeight:100,children:(0,a.jsx)("img",{ref:L,alt:"Crop me",src:M,onLoad:function(e){let{width:t,height:s}=e.currentTarget;Y((0,R.ge)((0,R.dS)({unit:"px",width:Math.floor(.9*Math.min(t,s))},1,t,s),t,s))},style:{maxBlockSize:"70vh"}})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-1",children:"Preview:"}),(0,a.jsx)("canvas",{ref:q,style:{border:"1px solid black",objectFit:"contain",inlineSize:null!=(e=null==z?void 0:z.width)?e:0,blockSize:null!=(t=null==z?void 0:z.height)?t:0,borderRadius:"50%"}})]})]}),(0,a.jsxs)(k.Es,{children:[(0,a.jsx)(k.HM,{asChild:!0,children:(0,a.jsx)(l.$,{variant:"outline",onClick:()=>{_(""),Y(void 0)},disabled:K,children:"Cancel"})}),(0,a.jsx)(l.$,{onClick:et,disabled:K||!(null==z?void 0:z.width),children:K?(0,a.jsx)(v.A,{className:"mr-2 h-4 w-4 animate-spin"}):"Save Cropped Photo"})]})]})})]}):(0,a.jsx)("div",{className:"flex min-h-[calc(100vh-var(--header-height,4rem))] items-center justify-center",children:(0,a.jsx)("p",{className:"text-destructive",children:"User not found. Please log in again."})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[2111,2992,3644,4763,4277,5296,9233,861,9965,329,8622,8441,1684,7358],()=>t(51677)),_N_E=e.O()}]);