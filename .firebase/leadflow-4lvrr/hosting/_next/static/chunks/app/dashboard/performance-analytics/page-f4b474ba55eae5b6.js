(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9337],{17313:(e,t,a)=>{"use strict";a.d(t,{Xi:()=>d,av:()=>c,j7:()=>o,tU:()=>i});var s=a(95155),r=a(12115),l=a(60704),n=a(59434);let i=l.bL,o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.B8,{ref:t,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...r})});o.displayName=l.B8.displayName;let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.l9,{ref:t,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...r})});d.displayName=l.l9.displayName;let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.UC,{ref:t,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...r})});c.displayName=l.UC.displayName},26126:(e,t,a)=>{"use strict";a.d(t,{E:()=>i});var s=a(95155);a(12115);var r=a(74466),l=a(59434);let n=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{className:(0,l.cn)(n({variant:a}),t),...r})}},34300:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>z});var s=a(95155),r=a(12115),l=a(80659),n=a(50286),i=a(81203),o=a(9041),d=a(40207),c=a(45554),u=a(74601),m=a(24334),f=a(83540),h=a(93504),g=a(94754),x=a(96025),p=a(16238),b=a(94517),v=a(24026),w=a(21374),y=a(3401),j=a(58227),S=a(98030),N=a(66695),D=a(26126),A=a(17313),k=a(47906),T=a(56104),R=a(35317);let C=(e,t,a)=>{try{let s=Array.isArray(e)?e:[],r=Array.isArray(t)?t:[],l=Array.isArray(a)?a:[],n=s.filter(e=>e&&e.status&&["sold","no_sale","credit_fail"].includes(e.status)).length,i=s.filter(e=>e&&"sold"===e.status).length,o=s.filter(e=>e&&"canceled"===e.status).length,d=s.length>0?o/s.length*100:0,c=s.filter(e=>e&&"immediate"===e.dispatchType&&["sold","no_sale","credit_fail"].includes(e.status)),u=s.filter(e=>e&&"immediate"===e.dispatchType&&"sold"===e.status).length,m=c.length>0?u/c.length*100:0,f=s.filter(e=>e&&"scheduled"===e.dispatchType&&["sold","no_sale","credit_fail"].includes(e.status)),h=s.filter(e=>e&&"scheduled"===e.dispatchType&&"sold"===e.status).length,g=f.length>0?h/f.length*100:0,x=s.filter(e=>e&&"immediate"===e.dispatchType),p=x.length>0?c.length/x.length*100:0,b=s.filter(e=>e&&"scheduled"===e.dispatchType),v=b.length>0?f.length/b.length*100:0;return{totalLeads:s.length,totalSetters:r.length,totalClosers:l.length,avgSitRate:s.length>0?n/s.length*100:0,avgCloseRate:n>0?i/n*100:0,totalRevenue:0,avgRevenuePerLead:s.length>0?0/s.length:0,conversionRate:s.length>0?i/s.length*100:0,canceledLeadRate:d,samedaySitCloseRate:m,scheduledAppointmentCloseRate:g,samedaySitRate:p,scheduledSitRate:v,leadsToday:0,leadsThisWeek:0,leadsThisMonth:s.length}}catch(e){return console.error("Error calculating team metrics:",e),{totalLeads:0,totalSetters:0,totalClosers:0,avgSitRate:0,avgCloseRate:0,totalRevenue:0,avgRevenuePerLead:0,conversionRate:0,canceledLeadRate:0,samedaySitCloseRate:0,scheduledAppointmentCloseRate:0,samedaySitRate:0,scheduledSitRate:0,leadsToday:0,leadsThisWeek:0,leadsThisMonth:0}}},I=[{icon:(0,s.jsx)(l.A,{className:"h-5 w-5"}),title:"Weekly Performance",description:"Get this week's sales performance summary",query:"Show me this week's sales performance compared to last week",category:"performance"},{icon:(0,s.jsx)(n.A,{className:"h-5 w-5"}),title:"Top Performers",description:"Who are our best closers this month?",query:"Who are the top 5 performing closers this month?",category:"team"},{icon:(0,s.jsx)(i.A,{className:"h-5 w-5"}),title:"Pipeline Analysis",description:"Review current pipeline status",query:"Analyze our current sales pipeline and forecast",category:"trends"},{icon:(0,s.jsx)(o.A,{className:"h-5 w-5"}),title:"Team Distribution",description:"How are leads distributed across teams?",query:"Show me how leads are distributed across our teams",category:"team"},{icon:(0,s.jsx)(d.A,{className:"h-5 w-5"}),title:"Daily Metrics",description:"Today's key performance indicators",query:"What are today's key metrics and how do they compare to our goals?",category:"performance"}];function E(e){if(!e)return null;if(e.includes("/")){let[t,a,s]=e.split("/");return new Date("".concat(s,"-").concat(t.padStart(2,"0"),"-").concat(a.padStart(2,"0")))}return new Date(e)}function W(e){return("string"==typeof e?new Date(e):e).toISOString().slice(0,10)}function M(e){let{trendingData:t,netSalesTrend:a}=e,[l,n]=(0,r.useState)(!1);return(0,s.jsxs)("div",{className:"mt-8",children:[(0,s.jsx)("button",{className:"mb-2 px-3 py-1 rounded bg-gradient-to-r from-blue-700 to-purple-700 text-white text-xs font-semibold shadow hover:opacity-90 transition",onClick:()=>n(e=>!e),children:l?"Hide Debug Panel":"Show Debug Panel"}),l&&(0,s.jsxs)("div",{className:"p-4 rounded-xl bg-[#18192a] border border-blue-900/40 text-xs text-left overflow-x-auto font-mono shadow-lg",children:[(0,s.jsx)("div",{className:"font-bold mb-1 text-blue-300",children:"Debug Panel"}),(0,s.jsx)("div",{className:"mb-1 text-blue-200",children:(0,s.jsx)("b",{children:"Raw trendingData (first 3 rows):"})}),(0,s.jsx)("pre",{className:"mb-2 text-blue-100",children:JSON.stringify(t.slice(0,3),null,2)}),(0,s.jsx)("div",{className:"mb-1 text-purple-200",children:(0,s.jsx)("b",{children:"Processed netSalesTrend (first 3 rows):"})}),(0,s.jsx)("pre",{className:"mb-2 text-purple-100",children:JSON.stringify(a.slice(0,3),null,2)}),(0,s.jsxs)("div",{className:"text-cyan-300",children:[(0,s.jsx)("b",{children:"Total net sales in range:"})," ",a.length]})]})]})}function z(){let{user:e}=(0,S.A)(),[t,a]=(0,r.useState)([{id:"1",content:"Hi! I'm your AI sales analytics assistant. I can help you analyze performance data, track trends, and answer questions about your sales metrics. What would you like to know?",isBot:!0,timestamp:new Date}]),[l,n]=(0,r.useState)(""),[i,o]=(0,r.useState)(!1),[d,z]=(0,r.useState)("all"),[F,P]=(0,r.useState)([]),[O,B]=(0,r.useState)({totalLeads:0,avgRevenuePerLead:0}),[_,U]=(0,r.useState)("all"),[K,Q]=(0,r.useState)("all"),[Z,q]=(0,r.useState)([]),[Y,G]=(0,r.useState)([]),[H,X]=(0,r.useState)([]),[J,V]=(0,r.useState)([]);(0,k.a)();let[$,ee]=(0,r.useState)("dashboard");(0,r.useEffect)(()=>{(null==e?void 0:e.teamId)&&(async()=>{let t=(0,R.query)((0,R.collection)(T.db,"leads"),(0,R.where)("teamId","==",e.teamId)),a=(await (0,R.getDocs)(t)).docs.map(e=>({id:e.id,...e.data()}));P(a),B(C(a,[],[]))})()},[null==e?void 0:e.teamId]),(0,r.useEffect)(()=>{e&&("admin"===e.role?(q(["West","East","South","North"]),G(["Team A","Team B","Team C"]),X([{name:"West",accounts:120,avgKW:6.2},{name:"East",accounts:90,avgKW:5.8},{name:"South",accounts:75,avgKW:6.5},{name:"North",accounts:60,avgKW:5.9}])):e.teamId&&(async()=>{let t=(0,R.query)((0,R.collection)(T.db,"leads"),(0,R.where)("teamId","==",e.teamId)),a=(await (0,R.getDocs)(t)).docs.map(e=>({id:e.id,...e.data()}));P(a),B(C(a,[],[]))})())},[e]),(0,r.useEffect)(()=>{!async function(){try{let e="https://docs.google.com/spreadsheets/d/e/2PACX-1vS1JbDgrzjZrpCmTLDtv44N3-NMvdc_bf15JvNErW3Qpxaj3DgCQlYfn5cDwZGH3RuD5yIWQm5SV0DN/pub?gid=1888217885&single=true&output=csv";if(!e)return;let t=await fetch(e),[a,...s]=(await t.text()).trim().split(/\r?\n/),r=a.split(","),l=s.map(e=>{let t=e.split(","),a={};return r.forEach((e,s)=>{var r;a[e.trim()]=null==(r=t[s])?void 0:r.trim()}),a});V(l)}catch(e){console.error("Failed to fetch trending CSV",e)}}()},[]),"all"===d||I.filter(e=>e.category===d);let et=(0,r.useMemo)(()=>{if(!J||0===J.length)return[];let e=new Date("2024-10-01"),t=new Date("2025-09-30"),a=J.filter(e=>{var t;return(null==(t=e.realization)?void 0:t.toString().trim())==="1"}).map(e=>{var t;return{date:E(null==(t=e.date_submitted)?void 0:t.trim())}}).filter(a=>a.date&&a.date>=e&&a.date<=t).sort((e,t)=>e.date.getTime()-t.date.getTime()),s={};a.forEach(e=>{let t=e.date.toISOString().slice(0,10);s[t]=(s[t]||0)+1});let r=0;return Object.keys(s).sort().map(e=>(r+=s[e],{date:e,netSales:r}))},[J]);function ea(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=e.getMonth()>=9?e.getFullYear():e.getFullYear()-1;return{start:new Date(t,9,1),end:new Date(t+1,9,1)}}let{start:es,end:er}=ea(),el=(0,r.useMemo)(()=>(function(e,t,a){let s=new Map(e.map(e=>[e.date,e.netSales])),r=[],l=new Date(t),n=0;for(;l<=a;){let e=l.toISOString().slice(0,10);s.has(e)?(n=s.get(e),r.push({date:e,netSales:n,isActual:!0})):r.push({date:e,netSales:n,isActual:!1}),l.setDate(l.getDate()+1)}return r})(et,es,er),[et,es,er]),en=(0,r.useMemo)(()=>L(es,er),[es,er]),ei=new Date,eo=W(ei),ed=el.slice().reverse().findIndex(e=>e.isActual&&new Date(e.date)<=ei),ec=-1===ed?-1:el.length-1-ed;-1!==ec&&el[ec];let eu=-1!==ec?el.slice(0,ec+1).map(e=>({...e,date:W(e.date)})):[],{start:em,end:ef}=ea();if((0,r.useMemo)(()=>L(em,ef),[em,ef]),(0,r.useEffect)(()=>{J&&J.length>0&&console.log("[Analytics] trendingData sample:",J.slice(0,3))},[J]),(0,r.useEffect)(()=>{el&&el.length>0&&console.log("[Analytics] netSalesTrend sample:",el.slice(0,3))},[el]),!e)return null;if("setter"===e.role)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,s.jsx)(N.Zp,{className:"max-w-md mx-auto",children:(0,s.jsx)(N.Wu,{className:"flex items-center justify-center p-8",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(c.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Analytics Not Available"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Analytics are available for closers and managers only."})]})})})});let eh=(0,r.useMemo)(()=>{let{start:e,end:t}=ea(),a=[],s=new Date(e.getFullYear(),e.getMonth(),1);for(;s<t;){let e="".concat(s.getFullYear(),"-").concat((s.getMonth()+1).toString().padStart(2,"0")),t=s.toLocaleString("en-US",{month:"short",year:"2-digit"});a.push({key:e,label:t}),s.setMonth(s.getMonth()+1)}let r={};return J.forEach(a=>{var s,l;let n=E(null==(s=a.date_submitted)?void 0:s.trim());if(!n||n<e||n>=t)return;let i="".concat(n.getFullYear(),"-").concat((n.getMonth()+1).toString().padStart(2,"0"));r[i]||(r[i]={netSales:0,totalSales:0}),r[i].totalSales+=1,(null==(l=a.realization)?void 0:l.toString().trim())==="1"&&(r[i].netSales+=1)}),a.map(e=>{var t,a;let{key:s,label:l}=e;return{month:l,netSales:(null==(t=r[s])?void 0:t.netSales)||0,totalSales:(null==(a=r[s])?void 0:a.totalSales)||0}})},[J]);(0,r.useMemo)(()=>{let{start:e,end:t}=ea(),a={};return el.forEach(s=>{let r=new Date(s.date);if(r>=e&&r<t){let e="".concat(r.getFullYear(),"-W").concat(function(e){let t=new Date(e.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+4-(t.getDay()||7));let a=new Date(t.getFullYear(),0,1);return Math.ceil(((t.getTime()-a.getTime())/864e5+1)/7).toString().padStart(2,"0")}(r));a[e]=(a[e]||0)+ +!!s.isActual}}),Object.entries(a).map(e=>{let[t,a]=e;return{week:t,netSales:a}})},[el]);let eg=el.filter(e=>e.isActual&&new Date(e.date)>=es&&new Date(e.date)<er),ex=0,ep=0;if(eg.length>1){let e=new Date(eg[eg.length-1].date),t=new Date(e);t.setDate(t.getDate()-84);let a=eg.filter(a=>new Date(a.date)>t&&new Date(a.date)<=e);if(a.length>1){let e=a[0],t=a[a.length-1],s=(new Date(t.date).getTime()-new Date(e.date).getTime())/864e5/7;ep=Math.round(365/7*(ex=s>0?(t.netSales-e.netSales)/s:0))}}return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex-1 space-y-6 p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-3",children:[(0,s.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-3 rounded-xl",children:(0,s.jsx)(c.A,{className:"h-8 w-8 text-white"})}),"Analytics"]}),(0,s.jsx)("p",{className:"text-muted-foreground mt-2",children:"Performance dashboards and AI-powered insights"})]}),(0,s.jsxs)(D.E,{variant:"secondary",className:"flex items-center gap-2",children:[(0,s.jsx)(u.A,{className:"h-4 w-4"}),"AI Powered"]})]}),(0,s.jsxs)(A.tU,{defaultValue:"overview",className:"w-full",children:[(0,s.jsxs)(A.j7,{className:"w-full flex flex-nowrap overflow-x-auto gap-1 mb-4 border-0 px-0 py-0 bg-gradient-to-br from-[#23243a]/80 to-[#18192a]/80 dark:from-[#23243a]/80 dark:to-[#18192a]/80 backdrop-blur-md rounded-xl shadow-lg",style:{fontSize:"1rem",background:"rgba(30,32,50,0.7)",boxShadow:"0 4px 24px 0 rgba(30,32,50,0.18)"},children:[(0,s.jsx)(A.Xi,{value:"overview",className:"flex-1 min-w-[110px] px-0 py-2 text-base sm:text-base whitespace-nowrap text-ellipsis overflow-hidden flex items-center gap-2 justify-center font-semibold rounded-none bg-transparent data-[state=active]:bg-white/10 data-[state=active]:text-white data-[state=active]:shadow-none data-[state=active]:border-none",children:"Overview"}),(0,s.jsx)(A.Xi,{value:"setters",className:"flex-1 min-w-[110px] px-0 py-2 text-base sm:text-base whitespace-nowrap text-ellipsis overflow-hidden flex items-center gap-2 justify-center font-semibold rounded-none bg-transparent data-[state=active]:bg-white/10 data-[state=active]:text-white data-[state=active]:shadow-none data-[state=active]:border-none",children:"Setters"}),(0,s.jsx)(A.Xi,{value:"closers",className:"flex-1 min-w-[110px] px-0 py-2 text-base sm:text-base whitespace-nowrap text-ellipsis overflow-hidden flex items-center gap-2 justify-center font-semibold rounded-none bg-transparent data-[state=active]:bg-white/10 data-[state=active]:text-white data-[state=active]:shadow-none data-[state=active]:border-none",children:"Closers"}),(0,s.jsx)(A.Xi,{value:"charts",className:"flex-1 min-w-[110px] px-0 py-2 text-base sm:text-base whitespace-nowrap text-ellipsis overflow-hidden flex items-center gap-2 justify-center font-semibold rounded-none bg-transparent data-[state=active]:bg-white/10 data-[state=active]:text-white data-[state=active]:shadow-none data-[state=active]:border-none",children:"Charts"}),(0,s.jsx)(A.Xi,{value:"ai-assistant",className:"flex-1 min-w-[110px] px-0 py-2 text-base sm:text-base whitespace-nowrap text-ellipsis overflow-hidden flex items-center gap-2 justify-center font-semibold rounded-none bg-transparent data-[state=active]:bg-white/10 data-[state=active]:text-white data-[state=active]:shadow-none data-[state=active]:border-none",children:"AI Assistant"})]}),(0,s.jsxs)(A.av,{value:"overview",className:"mt-6 space-y-6",children:[(0,s.jsxs)(N.Zp,{className:"analytics-card shadow-2xl border-0 bg-gradient-to-br from-[#23243a]/90 to-[#18192a]/90 backdrop-blur-xl",children:[(0,s.jsxs)(N.aR,{children:[(0,s.jsxs)(N.ZB,{className:"flex items-center gap-2 text-2xl font-extrabold tracking-tight text-white drop-shadow",children:[(0,s.jsx)(m.A,{className:"h-7 w-7 text-blue-400"}),"Net Sales Trend (Oct 1, 2024 – Oct 1, 2025)"]}),(0,s.jsxs)(N.BT,{className:"text-blue-200",children:["Weekly Average Sales (last 12 weeks): ",(0,s.jsx)("b",{children:ex.toLocaleString(void 0,{maximumFractionDigits:2})})," \xa0|\xa0 Annual Projected Sales: ",(0,s.jsx)("b",{children:ep.toLocaleString()})]})]}),(0,s.jsx)(N.Wu,{children:(0,s.jsx)("div",{className:"w-full",children:(0,s.jsx)(f.u,{width:"100%",height:420,children:(0,s.jsxs)(h.b,{data:el,children:[(0,s.jsx)("defs",{children:(0,s.jsxs)("linearGradient",{id:"colorNetSales",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,s.jsx)("stop",{offset:"0%",stopColor:"#6366f1",stopOpacity:.8}),(0,s.jsx)("stop",{offset:"100%",stopColor:"#6366f1",stopOpacity:.1})]})}),(0,s.jsx)(g.d,{strokeDasharray:"3 3",stroke:"#2e2e4d"}),(0,s.jsx)(x.W,{dataKey:"date",type:"category",domain:[W(es),W(er)],tick:{fill:"#b3baff",fontSize:13},minTickGap:24,interval:0,angle:-30,textAnchor:"end",height:60,ticks:en,tickFormatter:e=>en.includes(e)?new Date(e).toLocaleDateString("en-US",{month:"short",year:"2-digit"}):""}),(0,s.jsx)(p.h,{yAxisId:"left",orientation:"left",stroke:"#6366f1",label:{value:"Cumulative Net Accounts",angle:-90,position:"insideLeft",fill:"#b3baff",fontSize:13},tick:{fill:"#b3baff",fontSize:13}}),(0,s.jsx)(b.m,{contentStyle:{backgroundColor:"#23243a",border:"1px solid #6366f1",color:"#fff",borderRadius:8,fontSize:13,inlineSize:320,whiteSpace:"pre-line"},wrapperStyle:{zIndex:1e3,pointerEvents:"auto"}}),(0,s.jsx)(v.s,{wrapperStyle:{color:"#b3baff"}}),(0,s.jsx)(w.N,{yAxisId:"left",type:"monotone",dataKey:"netSales",stroke:"#6366f1",strokeWidth:3,name:"Net Accounts",data:eu,dot:e=>{let{cx:t,cy:a,payload:r,...l}=e;return r.date===eo?(0,s.jsx)("circle",{cx:t,cy:a,r:7,fill:"#6366f1",filter:"drop-shadow(0 0 8px #6366f1)"},r.date):null},isAnimationActive:!1,strokeDasharray:"0",connectNulls:!1})]})})})})]}),(0,s.jsxs)(N.Zp,{className:"analytics-card shadow-2xl border-0 bg-gradient-to-br from-[#23243a]/90 to-[#18192a]/90 backdrop-blur-xl mt-8",children:[(0,s.jsxs)(N.aR,{children:[(0,s.jsxs)(N.ZB,{className:"flex items-center gap-2 text-xl font-extrabold tracking-tight text-white drop-shadow",children:[(0,s.jsx)(m.A,{className:"h-6 w-6 text-blue-400"}),"Monthly Net Sales Snapshot"]}),(0,s.jsx)(N.BT,{className:"text-blue-200",children:"Total Gross, Total Net, Realization %."})]}),(0,s.jsx)(N.Wu,{children:(0,s.jsx)("div",{className:"w-full",children:(0,s.jsx)(f.u,{width:"100%",height:260,children:(0,s.jsxs)(y.E,{data:eh,children:[(0,s.jsx)(g.d,{strokeDasharray:"3 3",stroke:"#2e2e4d"}),(0,s.jsx)(x.W,{dataKey:"month",tick:{fill:"#b3baff",fontSize:13},interval:0,angle:-30,textAnchor:"end"}),(0,s.jsx)(p.h,{tick:{fill:"#b3baff",fontSize:13}}),(0,s.jsx)(b.m,{contentStyle:{backgroundColor:"#23243a",border:"1px solid #6366f1",color:"#fff",borderRadius:8,fontSize:13}}),(0,s.jsx)(v.s,{wrapperStyle:{color:"#b3baff"}}),(0,s.jsx)(j.y,{dataKey:"totalSales",fill:"#6366f1",name:"Total Sales",label:{position:"top",fill:"#b3baff",fontSize:13},activeBar:{fill:"#6366f1",stroke:"none"}}),(0,s.jsx)(j.y,{dataKey:"netSales",fill:"#a5b4fc",name:"Net Sales",label:{position:"top",fill:"#a5b4fc",fontSize:13},activeBar:{fill:"#a5b4fc",stroke:"none"}})]})})})})]}),(0,s.jsx)(M,{trendingData:J,netSalesTrend:el})]})]})]})})}function L(e,t){let a=[],s=new Date(e.getFullYear(),e.getMonth(),1);for(;s<=t;)a.push(s.toISOString().slice(0,10)),s.setMonth(s.getMonth()+1);return a}},47906:(e,t,a)=>{"use strict";a.d(t,{a:()=>r});var s=a(12115);function r(){let[e,t]=s.useState(void 0);return s.useEffect(()=>{let e=()=>{let e=window.innerWidth,a=window.innerHeight;t(e<768||a/e>1.3)},a=window.matchMedia("(max-inline-size: ".concat(767,"px)"));return a.addEventListener("change",e),window.addEventListener("resize",e),e(),()=>{a.removeEventListener("change",e),window.removeEventListener("resize",e)}},[]),!!e}},56104:(e,t,a)=>{"use strict";a.d(t,{EF:()=>f,IG:()=>u,V$:()=>h,db:()=>c,j2:()=>d,yA:()=>o});var s=a(23915),r=a(93004),l=a(35317),n=a(90858),i=a(81427);let o=(0,s.Dk)().length?(0,s.Sx)():(0,s.Wp)({apiKey:"AIzaSyBc3jmFE6dRXBApmWD9Jg2PO86suqGgaZw",authDomain:"leadflow-4lvrr.firebaseapp.com",projectId:"leadflow-4lvrr",storageBucket:"leadflow-4lvrr.firebasestorage.app",messagingSenderId:"13877630896",appId:"1:13877630896:web:ab7d2717024960ec36e875",measurementId:"G-KDEF2C21SH"}),d=(0,r.xI)(o),c=(0,l.aU)(o),u=(0,n.c7)(o),m=(0,i.Uz)(o),f=(0,i.Qg)(m,"acceptJob"),h=(0,i.Qg)(m,"inviteUser");(0,i.Qg)(m,"updateAdminRoles"),(0,i.Qg)(m,"getTeamStats"),(0,i.Qg)(m,"getDetailedAnalytics"),(0,i.Qg)(m,"generateAnalyticsReport")},59434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var s=a(52596),r=a(39688);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},66695:(e,t,a)=>{"use strict";a.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>n,aR:()=>i,wL:()=>u});var s=a(95155),r=a(12115),l=a(59434);let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,"data-card":"true",className:(0,l.cn)("rounded-2xl overflow-hidden border border-slate-200 bg-white text-card-foreground","shadow-lg shadow-slate-200/50 hover:shadow-xl hover:shadow-slate-300/50","transition-all duration-200 ease-in-out","mobile:rounded-xl mobile:mx-2 mobile:shadow-md","mobile:border-slate-300/50",a),...r})});n.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6","mobile:p-4 mobile:space-y-1",a),...r})});i.displayName="CardHeader";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("h3",{ref:t,className:(0,l.cn)("text-3xl font-bold font-headline leading-tight tracking-tight text-center","mobile:text-xl mobile:leading-snug","tablet:text-2xl",a),...r})});o.displayName="CardTitle";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("p",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground text-center","mobile:text-xs mobile:leading-relaxed",a),...r})});d.displayName="CardDescription";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",a),...r})});c.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",a),...r})});u.displayName="CardFooter"},96219:(e,t,a)=>{Promise.resolve().then(a.bind(a,34300))},98030:(e,t,a)=>{"use strict";a.d(t,{A:()=>m,AuthProvider:()=>u});var s=a(95155),r=a(93004),l=a(35317),n=a(35695),i=a(12115),o=a(56104),d=a(50172);let c=(0,i.createContext)(void 0),u=e=>{let{children:t}=e,[a,u]=(0,i.useState)(null),[m,f]=(0,i.useState)(null),[h,g]=(0,i.useState)(!0),[x,p]=(0,i.useState)(!1),b=(0,n.useRouter)(),v=(0,n.usePathname)(),w=(0,i.useRef)({isNavigating:!1});(0,i.useEffect)(()=>{console.log("\uD83D\uDD25 Setting up Firebase auth listener");let e=(0,r.hg)(o.j2,async e=>{if(console.log("\uD83D\uDD25 Firebase auth state changed:",!!e,"uid:",null==e?void 0:e.uid),(null==a?void 0:a.uid)===(null==e?void 0:e.uid)&&x)return void console.log("\uD83D\uDD04 Same user, skipping update");u(e),p(!0),!e&&(f(null),g(!1),"/login"===v||w.current.isNavigating||(w.current.isNavigating=!0,console.log("\uD83D\uDEAA Redirecting to login"),b.replace("/login"),setTimeout(()=>{w.current.isNavigating=!1},1e3)))});return()=>{console.log("\uD83D\uDD25 Cleaning up Firebase auth listener"),e()}},[]),(0,i.useEffect)(()=>{let e;if(a&&x){console.log("\uD83D\uDC64 Setting up user document listener for:",a.uid);let t=(0,l.doc)(o.db,"users",a.uid);e=(0,l.aQ)(t,async e=>{if(console.log("\uD83D\uDCC4 User document snapshot received, exists:",e.exists()),e.exists()){let t={uid:a.uid,...e.data()};f(t),g(!1),console.log("✅ User data loaded:",t.email,t.role),"/login"!==v||w.current.isNavigating||(w.current.isNavigating=!0,console.log("\uD83C\uDFE0 Redirecting to dashboard"),b.replace("/dashboard"),setTimeout(()=>{w.current.isNavigating=!1},1e3))}else{console.log("\uD83D\uDCDD Creating default user document");let e={uid:a.uid,email:a.email||"",displayName:a.displayName||"",role:"setter",teamId:"default",avatarUrl:a.photoURL||null,phoneNumber:a.phoneNumber||null,status:"On Duty",createdAt:new Date().toISOString()};try{await (0,l.setDoc)(t,e),f(e),g(!1),console.log("✅ Default user document created")}catch(e){console.error("❌ Failed to create user document:",e),f(null),g(!1)}}},e=>{console.error("❌ User document listener error:",e),f(null),g(!1)})}else!a&&x&&(f(null),g(!1));return()=>{e&&(console.log("\uD83E\uDDF9 Cleaning up user document listener"),e())}},[a,x,v,b]);let y=async()=>{console.log("\uD83D\uDC4B Logging out"),w.current.isNavigating=!0,g(!0);try{await (0,r.CI)(o.j2),f(null),u(null),b.replace("/login")}catch(e){console.error("❌ Logout error:",e)}finally{g(!1),setTimeout(()=>{w.current.isNavigating=!1},1e3)}};if(h&&!x)return(0,s.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-background",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)(d.A,{className:"h-12 w-12 animate-spin text-primary"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading..."})]})});let j={firebaseUser:a,user:m,loading:h,teamId:(null==m?void 0:m.teamId)||null,role:(null==m?void 0:m.role)||null,logout:y};return(0,s.jsx)(c.Provider,{value:j,children:t})},m=()=>{let e=(0,i.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,3644,4763,4277,5296,9196,8466,8441,1684,7358],()=>t(96219)),_N_E=e.O()}]);