(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105],{5497:(e,t,s)=>{Promise.resolve().then(s.bind(s,7448))},7448:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>ee});var a=s(95155),r=s(12115),l=s(98030),i=s(87481),n=s(56104),d=s(35317),o=s(22715),c=s(66695),m=s(91394),u=s(57082),p=s(50172),h=s(57804),x=s(63920),f=s(20203),g=s(73926),v=s(80333),w=s(85057),b=s(30285),N=s(54165),j=s(26126),y=s(45731),k=s(91721),A=s(19637),C=s(10518),I=s(15599),T=s(31554);function D(e){let{isOpen:t,onClose:s,profile:l}=e,{toast:n}=(0,i.dj)(),[d,o]=(0,r.useState)(null),c=l.name||l.displayName||"Unknown User",u=l.email,p=l.phone||l.phoneNumber,h=l.role||"User",x=l.avatarUrl||"https://ui-avatars.com/api/?name=".concat(c.replace(/\s+/g,"+"),"&background=random&color=fff"),f=async(e,t)=>{try{if("undefined"!=typeof navigator&&navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(e),o(t),n({title:"Copied!",description:"".concat(t," copied to clipboard")}),setTimeout(()=>o(null),2e3);else{let s=document.createElement("textarea");s.value=e,s.style.position="fixed",s.style.left="-999999px",s.style.top="-999999px",document.body.appendChild(s),s.focus(),s.select();try{document.execCommand("copy"),o(t),n({title:"Copied!",description:"".concat(t," copied to clipboard")}),setTimeout(()=>o(null),2e3)}catch(e){throw Error("Copy operation not supported")}finally{document.body.removeChild(s)}}}catch(e){n({title:"Copy Failed",description:"Could not copy to clipboard. Please copy manually.",variant:"destructive"})}};return(0,a.jsx)(N.lG,{open:t,onOpenChange:e=>!e&&s(),children:(0,a.jsxs)(N.Cf,{className:"sm:max-w-md dark:card-glass dark:glow-turquoise",children:[(0,a.jsx)(N.c7,{children:(0,a.jsxs)(N.L3,{className:"font-headline flex items-center justify-center",children:[(0,a.jsx)(k.A,{className:"mr-2 h-6 w-6 text-primary"}),"Team Member Profile"]})}),(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-6 py-4",children:[(0,a.jsxs)(m.eu,{className:"h-20 w-20 border-2 border-primary shadow-lg",children:[(0,a.jsx)(m.BK,{src:x,alt:c}),(0,a.jsx)(m.q5,{className:"bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-800 dark:to-blue-900 text-blue-900 dark:text-blue-100 font-bold text-lg",children:c.substring(0,2).toUpperCase()})]}),(0,a.jsxs)("div",{className:"text-center space-y-2",children:[(0,a.jsx)("h3",{className:"text-xl font-bold font-headline",children:c}),(0,a.jsxs)(j.E,{variant:(e=>{switch(e.toLowerCase()){case"manager":return"default";case"closer":default:return"secondary";case"setter":return"outline"}})(h),className:"flex items-center gap-1",children:["manager"===h.toLowerCase()?(0,a.jsx)(y.A,{className:"h-3 w-3"}):(0,a.jsx)(k.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"capitalize",children:h})]})]}),(0,a.jsxs)("div",{className:"w-full space-y-3",children:[u&&(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/50 dark:bg-slate-800/40 dark:border dark:border-turquoise/20 rounded-lg dark:glow-turquoise",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[(0,a.jsx)(A.A,{className:"h-4 w-4 text-muted-foreground dark:text-turquoise/80 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground dark:text-gray-400 uppercase tracking-wide",children:"Email"}),(0,a.jsx)("p",{className:"font-medium truncate dark:text-gray-200",children:u})]})]}),(0,a.jsx)(b.$,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 flex-shrink-0 dark:hover:bg-turquoise/10",onClick:()=>f(u,"Email"),children:"Email"===d?(0,a.jsx)(C.A,{className:"h-4 w-4 text-green-600 dark:text-turquoise"}):(0,a.jsx)(I.A,{className:"h-4 w-4 dark:text-gray-300"})})]}),p&&(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/50 dark:bg-slate-800/40 dark:border dark:border-cyan/20 rounded-lg dark:glow-cyan",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[(0,a.jsx)(T.A,{className:"h-4 w-4 text-muted-foreground dark:text-cyan/80 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground dark:text-gray-400 uppercase tracking-wide",children:"Phone"}),(0,a.jsx)("p",{className:"font-medium dark:text-gray-200",children:p})]})]}),(0,a.jsx)(b.$,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 flex-shrink-0 dark:hover:bg-cyan/10",onClick:()=>f(p,"Phone"),children:"Phone"===d?(0,a.jsx)(C.A,{className:"h-4 w-4 text-green-600 dark:text-cyan"}):(0,a.jsx)(I.A,{className:"h-4 w-4 dark:text-gray-300"})})]}),!u&&!p&&(0,a.jsx)("div",{className:"text-center py-4",children:(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No contact information available"})})]})]})]})})}function S(e){var t,s;let{closer:o,allowInteractiveToggle:N=!0,onMove:j,canMoveUp:y,canMoveDown:k,showMoveControls:A,isUpdatingOrder:C,assignedLeadName:I,onLeadClick:T,onDispositionChange:S,showDispositionSelector:O=!1,currentLeadStatus:E,leadId:U,position:L}=e,{user:P}=(0,l.A)(),{toast:_}=(0,i.dj)(),[M,F]=(0,r.useState)(!1),[q,z]=(0,r.useState)(!1),B="accepted"===E,G="scheduled"===E,Q="waiting_assignment"===E,R=P&&("manager"===P.role||"admin"===P.role||"closer"===P.role&&P.uid===o.uid),W=R&&N&&!I,V=async e=>{if(!P||!R||I)return;F(!0);let t=e?"On Duty":"Off Duty";try{let e=(0,d.doc)(n.db,"closers",o.uid);await (0,d.updateDoc)(e,{status:t}),_({title:"Status Updated",description:"".concat(o.name||"Closer","'s status set to ").concat(t,".")})}catch(e){_({title:"Update Failed",description:"Could not update ".concat(o.name||"Closer","'s status."),variant:"destructive"})}finally{F(!1)}},$="On Duty"===o.status,Z=o.avatarUrl||"https://ui-avatars.com/api/?name=".concat((o.name||"User").replace(/\s+/g,"+"),"&background=random&color=fff"),J=o.avatarUrl?void 0:(null==(s=o.name)||null==(t=s.split(" ")[0])?void 0:t.toLowerCase())||"person";return(0,a.jsxs)(c.Zp,{className:"shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 dark:border-slate-700",children:[(0,a.jsxs)(c.Wu,{className:"p-4 sm:p-5 lg:p-6",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3 sm:space-x-4",children:[L&&(0,a.jsx)("div",{className:"flex-shrink-0 flex items-center justify-center w-6 h-6 sm:w-7 sm:h-7 lg:w-8 lg:h-8 text-slate-600 text-sm sm:text-base font-bold rounded-full border border-slate-300",children:L}),(0,a.jsxs)(m.eu,{className:"h-12 w-12 sm:h-14 sm:w-14 lg:h-16 lg:w-16 border-2 shadow-lg flex-shrink-0 cursor-pointer transition-all duration-300 border-slate-200 hover:border-primary hover:shadow-xl",onClick:()=>{z(!0)},children:[(0,a.jsx)(m.BK,{src:Z,alt:o.name||"User","data-ai-hint":J}),(0,a.jsx)(m.q5,{className:"font-bold text-sm sm:text-base lg:text-lg bg-blue-100 text-blue-900",children:o.name?o.name.substring(0,2).toUpperCase():"N/A"})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0 pr-2",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("p",{className:"text-sm sm:text-base lg:text-lg font-bold font-headline text-gray-900 dark:text-gray-100 truncate",children:o.name||"Unnamed Closer"})}),I?(0,a.jsxs)("div",{className:"flex items-center text-sm sm:text-base mt-2 ".concat(T?"cursor-pointer hover:text-blue-600 transition-colors":""," text-blue-700 dark:text-blue-300"),onClick:()=>{T&&T()},role:T?"button":void 0,tabIndex:T?0:void 0,onKeyDown:T?e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),T())}:void 0,children:[(0,a.jsx)(u.A,{className:"mr-2 h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"}),(0,a.jsxs)("span",{className:"font-medium truncate",children:["Working on: ",I]})]}):W?(0,a.jsxs)("div",{className:"flex items-center space-x-3 mt-2",children:[(0,a.jsx)(v.d,{id:"status-toggle-".concat(o.uid),checked:$,onCheckedChange:V,disabled:M||C,"aria-label":$?"Set ".concat(o.name||"Closer"," to Off Duty"):"Set ".concat(o.name||"Closer"," to On Duty"),className:"scale-90 sm:scale-100"}),(0,a.jsx)(w.J,{htmlFor:"status-toggle-".concat(o.uid),className:"text-sm sm:text-base font-medium ".concat($?"text-green-700 dark:text-green-400":"text-red-600 dark:text-red-400"),children:M?(0,a.jsx)(p.A,{className:"h-4 w-4 animate-spin"}):$?"Available":"Off Duty"})]}):(0,a.jsxs)("div",{className:"flex items-center text-sm sm:text-base mt-2 ".concat($?"text-green-700 dark:text-green-400":"text-red-600 dark:text-red-400"),children:[$?(0,a.jsx)(h.A,{className:"mr-2 h-4 w-4 sm:h-5 sm:w-5"}):(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4 sm:h-5 sm:w-5"}),(0,a.jsx)("span",{className:"font-medium",children:$?"Available":"Off Duty"})]})]})]}),(Q||G||B)&&S||A&&j&&!I?(0,a.jsxs)("div",{className:"flex items-center justify-end space-x-2 mt-3 pt-3 border-t border-slate-200 dark:border-slate-700",children:[(Q||G)&&((null==P?void 0:P.role)==="manager"||(null==P?void 0:P.role)==="admin")&&S&&(0,a.jsx)(b.$,{size:"sm",className:"h-7 sm:h-8 px-2 sm:px-3 text-xs sm:text-sm bg-green-500/80 backdrop-blur-sm hover:bg-green-600/90 text-white border border-green-400/30 hover:border-green-300/50 transition-all duration-300",onClick:()=>{S("in_process"),_({title:"Lead Accepted",description:"Lead has been accepted and is now in process."})},children:"Accept & Start"}),G&&(null==P?void 0:P.role)==="closer"&&S&&(0,a.jsx)(b.$,{size:"sm",className:"h-7 sm:h-8 px-2 sm:px-3 text-xs sm:text-sm bg-green-500/80 backdrop-blur-sm hover:bg-green-600/90 text-white border border-green-400/30 hover:border-green-300/50 transition-all duration-300",onClick:()=>{S("accepted"),_({title:"Job Accepted",description:"Job has been accepted."})},children:"Accept Job"}),B&&(null==P?void 0:P.role)==="closer"&&S&&(0,a.jsx)(b.$,{size:"sm",className:"h-7 sm:h-8 px-2 sm:px-3 text-xs sm:text-sm bg-blue-500/80 backdrop-blur-sm hover:bg-blue-600/90 text-white border border-blue-400/30 hover:border-blue-300/50 transition-all duration-300",onClick:()=>{S("in_process"),_({title:"Lead Status Updated",description:"You are now actively working on this lead."})},children:"Start Working"}),A&&j&&!I&&(0,a.jsxs)("div",{className:"flex items-center space-x-1 ml-2",children:[(0,a.jsx)(b.$,{variant:"ghost",size:"icon",className:"h-6 w-6 sm:h-7 sm:w-7",onClick:()=>j("up"),disabled:!y||M||C,children:(0,a.jsx)(f.A,{className:"h-3 w-3 sm:h-4 sm:w-4"})}),(0,a.jsx)(b.$,{variant:"ghost",size:"icon",className:"h-6 w-6 sm:h-7 sm:w-7",onClick:()=>j("down"),disabled:!k||M||C,children:(0,a.jsx)(g.A,{className:"h-3 w-3 sm:h-4 sm:w-4"})})]})]}):null]}),(0,a.jsx)(D,{isOpen:q,onClose:()=>z(!1),profile:{uid:o.uid,name:o.name||"Unnamed Closer",email:null,phone:o.phone||null,avatarUrl:o.avatarUrl||"https://ui-avatars.com/api/?name=".concat((o.name||"User").replace(/\s+/g,"+"),"&background=random&color=fff"),role:"closer"}})]})}var O=s(40207),E=s(19677),U=s(66424);function L(){let{user:e}=(0,l.A)(),{toast:t}=(0,i.dj)(),[s,m]=(0,r.useState)([]),[u,h]=(0,r.useState)(!0),[x,f]=(0,r.useState)(!0),[g,v]=(0,r.useState)([]),[w,b]=(0,r.useState)(null),[j,y]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!e||!e.teamId){f(!1),v([]);return}f(!0);let s=(0,d.query)((0,d.collection)(n.db,"closers"),(0,d.where)("teamId","==",e.teamId)),a=(0,d.aQ)(s,e=>{v(e.docs.map(e=>({uid:e.id,...e.data()}))),f(!1)},e=>{console.error("Error loading team closers:",e),t({title:"Error",description:"Failed to load team closers: ".concat(e.message||"Unknown error",". Please refresh the page."),variant:"destructive"}),f(!1)});return()=>a()},[e,t]),(0,r.useEffect)(()=>{if(!e||!e.teamId||x){e&&e.teamId||h(!1),x&&m([]);return}h(!0);let s=(0,d.query)((0,d.collection)(n.db,"leads"),(0,d.where)("teamId","==",e.teamId),(0,d.My)("createdAt","desc"),(0,d.AB)(100)),a=(0,d.aQ)(s,t=>{let s=t.docs.filter(t=>{let s=t.data();return"closer"===e.role?s.assignedCloserId===e.uid&&["waiting_assignment","accepted","in_process"].includes(s.status):"setter"===e.role?"in_process"===s.status:("manager"===e.role||"admin"===e.role)&&s.assignedCloserId&&["waiting_assignment","accepted","in_process"].includes(s.status)}),a="manager"===e.role||"admin"===e.role?20:"setter"===e.role?15:10;m((s=s.slice(0,a)).map(e=>{let t={id:e.id,...e.data()},s=g.find(e=>e.uid===t.assignedCloserId);return{lead:t,closer:s}})),h(!1)},e=>{console.error("Error loading in-process leads:",e),t({title:"Error",description:"Failed to load in-process leads: ".concat(e.message||"Unknown error",". Please refresh the page."),variant:"destructive"}),m([]),h(!1)});return()=>a()},[e,g,x,t]);let k=u||x,A=async s=>{if((null==e?void 0:e.role)==="manager"||(null==e?void 0:e.role)==="admin"||(null==e?void 0:e.role)==="closer"&&e.uid===s.assignedCloserId){if((null==e?void 0:e.role)==="closer"&&e.uid===s.assignedCloserId&&("waiting_assignment"===s.status||"scheduled"===s.status)&&!s.acceptedAt)try{let e=(await (0,n.EF)({leadId:s.id})).data;e.success&&!e.alreadyAccepted&&t({title:"Job Accepted",description:"You have accepted the job for ".concat(s.customerName,". The setter has been notified.")})}catch(e){console.error("Error accepting job:",e),t({title:"Acceptance Failed",description:"Failed to accept the job. Please try again.",variant:"destructive"});return}b(s),y(!0)}else t({title:"Access Denied",description:"You can only view details for leads assigned to you.",variant:"destructive"})},C=async(s,a)=>{if(!e||"closer"!==e.role&&"manager"!==e.role&&"admin"!==e.role)return void t({title:"Access Denied",description:"Only closers and managers can update lead disposition.",variant:"destructive"});try{let r=(0,d.doc)(n.db,"leads",s),l=await (0,d.getDoc)(r);if(!l.exists())throw Error("Lead not found");let i=l.data();("manager"===e.role||"admin"===e.role)&&("waiting_assignment"===i.status||"scheduled"===i.status||"accepted"===i.status)&&["sold","no_sale","canceled","rescheduled","credit_fail"].includes(a)?"in_process"!==i.status&&(await (0,d.updateDoc)(r,{status:"in_process",updatedAt:(0,d.serverTimestamp)()}),await new Promise(e=>setTimeout(e,100))):"closer"===e.role&&"accepted"===i.status&&["sold","no_sale","canceled","rescheduled","credit_fail"].includes(a)&&(await (0,d.updateDoc)(r,{status:"in_process",updatedAt:(0,d.serverTimestamp)()}),await new Promise(e=>setTimeout(e,100)));let o={status:a,updatedAt:(0,d.serverTimestamp)(),dispositionUpdatedBy:e.uid,dispositionUpdatedAt:(0,d.serverTimestamp)()};("manager"===e.role||"admin"===e.role)&&"waiting_assignment"===a&&(o.assignedCloserId=null,o.assignedCloserName=null),await (0,d.updateDoc)(r,o),t({title:"Disposition Updated",description:"Lead status updated to ".concat(a.replace("_"," "),".")})}catch(e){console.error("Error updating lead disposition:",e),t({title:"Update Failed",description:"Failed to update lead disposition. Please try again.",variant:"destructive"})}};return(0,a.jsxs)(c.Zp,{className:"h-full flex flex-col bg-white dark:bg-slate-900 shadow-lg hover:shadow-xl transition-all duration-200 border-0 ring-1 ring-slate-200 dark:ring-slate-800",children:[(0,a.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-3 px-4 pt-4 shrink-0",children:[(0,a.jsxs)(c.ZB,{className:"text-lg sm:text-xl font-bold font-headline flex items-center text-slate-900 dark:text-slate-100 premium:text-premium-purple premium:text-glow",children:[(0,a.jsx)(O.A,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 text-green-500 animate-pulse premium:icon-glow-teal"}),(0,a.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,a.jsx)("span",{className:"text-sm sm:text-base leading-tight",children:"In Process Leads"}),(0,a.jsx)("span",{className:"text-xs font-normal text-muted-foreground premium:text-premium-teal truncate",children:"Active customer interactions"})]})]}),k&&(0,a.jsx)(p.A,{className:"h-4 w-4 animate-spin text-muted-foreground shrink-0"})]}),(0,a.jsx)(c.Wu,{className:"flex-grow overflow-hidden px-4 pb-4",children:k?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(p.A,{className:"h-6 w-6 sm:h-8 sm:w-8 animate-spin text-primary mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading leads..."})]})}):0===s.length?(0,a.jsxs)("div",{className:"flex h-full flex-col items-center justify-center text-center py-8",children:[(0,a.jsx)("div",{className:"flex items-center justify-center mb-4",style:{blockSize:48},children:(0,a.jsx)(E.A,{className:"h-8 w-8 sm:h-12 sm:w-12 text-white stroke-2",fill:"none",stroke:"currentColor",strokeWidth:2})}),(0,a.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-foreground mb-2",children:"All Quiet"}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm max-w-xs",children:"No leads are currently being processed. New leads will appear here when closers start working on them."})]}):(0,a.jsx)("div",{className:"h-full overflow-hidden",children:(0,a.jsx)(U.F,{className:"h-full",children:(0,a.jsx)("div",{className:"space-y-3 pr-2",children:s.map((t,s)=>{let{lead:r,closer:l}=t,i=(null==e?void 0:e.role)==="manager"||(null==e?void 0:e.role)==="admin"||(null==e?void 0:e.role)==="closer"&&("in_process"===r.status||"accepted"===r.status);return(0,a.jsx)("div",{children:l&&(0,a.jsx)(S,{closer:l,assignedLeadName:r.customerName,allowInteractiveToggle:!1,onLeadClick:()=>A(r),onDispositionChange:e=>C(r.id,e),showDispositionSelector:i,currentLeadStatus:r.status,leadId:r.id,position:s+1})},r.id)})})})})}),(0,a.jsx)(N.lG,{open:j,onOpenChange:y,children:(0,a.jsxs)(N.Cf,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(N.c7,{children:(0,a.jsx)(N.L3,{children:"Lead Details"})}),w&&(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(o.A,{lead:w,context:"in-process"})})]})})]})}var P=s(50286);function _(e){let{isOpen:t,onClose:s}=e,{user:o}=(0,l.A)(),{toast:c}=(0,i.dj)(),[m,u]=(0,r.useState)([]),[h,x]=(0,r.useState)(!0),[f,g]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!t||!o||!o.teamId||"manager"!==o.role&&"admin"!==o.role){x(!1),u([]);return}x(!0);let e=(0,d.query)((0,d.collection)(n.db,"closers"),(0,d.where)("teamId","==",o.teamId),(0,d.My)("name","asc")),s=(0,d.aQ)(e,e=>{let t=e.docs.map(e=>{let t=e.data();return{uid:e.id,name:t.name,status:t.status,teamId:t.teamId,role:t.role,avatarUrl:t.avatarUrl,phone:t.phone,lineupOrder:t.lineupOrder}});(t=t.map((e,t)=>({...e,lineupOrder:"number"==typeof e.lineupOrder?e.lineupOrder:(t+1)*1e5}))).sort((e,t)=>{let s=e.lineupOrder,a=t.lineupOrder;return s!==a?s-a:e.name.localeCompare(t.name)}),u(t),x(!1)},e=>{c({title:"Error",description:"Failed to load closer information. Please try again.",variant:"destructive"}),x(!1)});return()=>s()},[t,o]);let v=async(e,t)=>{g(!0);let s=m.findIndex(t=>t.uid===e);if(-1===s){c({title:"Error",description:"Closer not found.",variant:"destructive"}),g(!1);return}let a=-1;if("up"===t&&s>0?a=s-1:"down"===t&&s<m.length-1&&(a=s+1),-1===a)return void g(!1);let r=m[s],l=m[a],i=(0,d.wP)(n.db),o=r.lineupOrder,u=l.lineupOrder,p=(0,d.doc)(n.db,"closers",r.uid);i.update(p,{lineupOrder:u});let h=(0,d.doc)(n.db,"closers",l.uid);i.update(h,{lineupOrder:o});try{await i.commit(),c({title:"Lineup Updated",description:"".concat(r.name," moved.")})}catch(e){c({title:"Update Failed",description:"Could not update lineup order.",variant:"destructive"})}finally{g(!1)}};return t?(0,a.jsx)(N.lG,{open:t,onOpenChange:e=>{e||s()},children:(0,a.jsxs)(N.Cf,{className:"sm:max-w-md",children:[(0,a.jsxs)(N.c7,{children:[(0,a.jsxs)(N.L3,{className:"font-headline flex items-center justify-center",children:[(0,a.jsx)(P.A,{className:"mr-2 h-6 w-6 text-primary"}),"Manage Closer Status & Lineup"]}),(0,a.jsx)(N.rr,{className:"text-center",children:"View all team closers, manage their duty status, and reorder the lineup."})]}),(0,a.jsx)("div",{className:"py-4",children:h?(0,a.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,a.jsx)(p.A,{className:"h-8 w-8 animate-spin text-primary"})}):0===m.length?(0,a.jsx)("div",{className:"flex h-40 items-center justify-center",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"No closers found for this team."})}):(0,a.jsx)(U.F,{className:"h-[calc(60vh)] max-h-[400px] pr-3",children:(0,a.jsx)("div",{className:"space-y-3",children:m.map((e,t)=>(0,a.jsx)(S,{closer:e,allowInteractiveToggle:!0,showMoveControls:(null==o?void 0:o.role)==="manager"||(null==o?void 0:o.role)==="admin",canMoveUp:t>0,canMoveDown:t<m.length-1,onMove:t=>v(e.uid,t),isUpdatingOrder:f},e.uid))})})})]})}):null}function M(){let{user:e}=(0,l.A)(),{toast:t}=(0,i.dj)(),[s,o]=(0,r.useState)([]),[m,u]=(0,r.useState)([]),[h,x]=(0,r.useState)(!0),[f,g]=(0,r.useState)(new Set),[v,w]=(0,r.useState)(!0),[b,N]=(0,r.useState)(!1),j=(null==e?void 0:e.role)==="manager"||(null==e?void 0:e.role)==="admin",y=(null==e?void 0:e.role)==="closer";(0,r.useEffect)(()=>{if(!(null==e?void 0:e.teamId)){g(new Set),w(!1);return}w(!0);let s=(0,d.query)((0,d.collection)(n.db,"leads"),(0,d.where)("teamId","==",e.teamId),(0,d.where)("status","in",["waiting_assignment","scheduled","accepted","in_process"])),a=(0,d.aQ)(s,e=>{let t=new Set;e.forEach(e=>{let s=e.data();s.assignedCloserId&&t.add(s.assignedCloserId)}),g(t),w(!1)},e=>{t({title:"Error",description:"Failed to load assigned closers. Please refresh the page.",variant:"destructive"}),g(new Set),w(!1)});return()=>a()},[null==e?void 0:e.teamId,t]),(0,r.useEffect)(()=>{if(!(null==e?void 0:e.teamId)){o([]),u([]),x(!1);return}if(v){o([]),u([]),x(!0);return}x(!0);let s=(0,d.query)((0,d.collection)(n.db,"closers"),(0,d.where)("teamId","==",e.teamId),(0,d.where)("status","==","On Duty"),(0,d.My)("name","asc")),a=(0,d.aQ)(s,e=>{let t=e.docs.map(e=>{let t=e.data();return{uid:e.id,name:t.name,status:t.status,teamId:t.teamId,role:t.role,avatarUrl:t.avatarUrl,phone:t.phone,lineupOrder:t.lineupOrder}}),s=t.filter(e=>!f.has(e.uid)).map((e,t)=>({...e,lineupOrder:"number"==typeof e.lineupOrder?e.lineupOrder:(t+1)*1e5})).sort((e,t)=>{let s=e.lineupOrder||999999,a=t.lineupOrder||999999;return s!==a?s-a:e.name.localeCompare(t.name)}),a=t.map((e,t)=>({...e,lineupOrder:"number"==typeof e.lineupOrder?e.lineupOrder:(t+1)*1e5})).sort((e,t)=>{let s=e.lineupOrder||999999,a=t.lineupOrder||999999;return s!==a?s-a:e.name.localeCompare(t.name)});o(s),u(a),x(!1)},e=>{t({title:"Error",description:"Failed to load closer lineup. Please refresh the page.",variant:"destructive"}),o([]),u([]),x(!1)});return()=>a()},[null==e?void 0:e.teamId,f,v,t]);let k=v||h,{closers:A,emptyTitle:C,emptyDescription:I,titleSuffix:T}=e&&e.role?y?{closers:m,emptyTitle:"No On Duty Closers",emptyDescription:"No closers are currently on duty.",titleSuffix:"On duty team members"}:{closers:s,emptyTitle:"No Available Closers",emptyDescription:"All closers are currently off duty or assigned to leads.",titleSuffix:"Available team members"}:{closers:[],emptyTitle:"Loading...",emptyDescription:"Please wait while we load your data.",titleSuffix:"Loading"};return e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c.Zp,{className:"h-full flex flex-col bg-white shadow-lg hover:shadow-xl transition-all duration-200 border-0 ring-1 ring-slate-200",children:[(0,a.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-3 px-4 pt-4 shrink-0",children:[(0,a.jsxs)(c.ZB,{className:"text-lg sm:text-xl font-bold font-headline flex items-center text-slate-900 dark:text-slate-100 premium:text-premium-purple premium:text-glow",children:[(0,a.jsx)("div",{className:"mr-2 rounded-lg flex items-center justify-center p-2 border-2 border-premium-purple dark:border-premium-purple premium:border-premium-purple premium:shadow-premium-purple premium:bg-gradient-to-br premium:from-premium-purple/80 premium:to-premium-teal/80 premium:icon-glow-purple",onClick:j?()=>{j&&N(!0)}:void 0,children:(0,a.jsx)(P.A,{className:"h-4 w-4 sm:h-5 sm:w-5 text-premium-purple premium:icon-glow-purple"})}),(0,a.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,a.jsx)("span",{className:"text-sm sm:text-base leading-tight",children:"Closer Lineup"}),(0,a.jsx)("span",{className:"text-xs font-normal text-muted-foreground premium:text-premium-teal truncate",children:T})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2 shrink-0",children:k&&(0,a.jsx)(p.A,{className:"h-4 w-4 animate-spin text-muted-foreground"})})]}),(0,a.jsx)(c.Wu,{className:"flex-grow overflow-hidden px-4 pb-4",children:0!==A.length||k?(0,a.jsx)("div",{className:"h-full overflow-hidden",children:(0,a.jsx)(U.F,{className:"h-full",children:(0,a.jsx)("div",{className:"space-y-3 pr-2",children:A.map((t,s)=>{let r=t.uid===(null==e?void 0:e.uid),l=f.has(t.uid);return(0,a.jsx)("div",{className:r?"ring-2 ring-blue-400 rounded-lg":"",children:(0,a.jsx)(S,{closer:t,allowInteractiveToggle:!1,position:s+1,assignedLeadName:l?"Working on lead":void 0})},t.uid)})})})}):(0,a.jsxs)("div",{className:"flex h-full flex-col items-center justify-center text-center py-8",children:[(0,a.jsx)("div",{className:"p-3 bg-slate-100 rounded-full mb-3",children:(0,a.jsx)(P.A,{className:"h-6 w-6 sm:h-8 sm:w-8 text-muted-foreground"})}),(0,a.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-foreground mb-2",children:C}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm max-w-xs",children:I}),e&&!e.teamId&&(0,a.jsx)("p",{className:"text-xs text-red-600 bg-red-50 px-3 py-1 rounded-md mt-2",children:"Error: User missing team assignment"})]})})]}),(0,a.jsx)(_,{isOpen:b,onClose:()=>N(!1)})]}):(0,a.jsx)(c.Zp,{className:"h-full flex flex-col bg-white shadow-lg hover:shadow-xl transition-all duration-200 border-0 ring-1 ring-slate-200",children:(0,a.jsx)(c.Wu,{className:"flex-grow overflow-hidden px-4 pb-4",children:(0,a.jsxs)("div",{className:"flex h-full flex-col items-center justify-center text-center py-8",children:[(0,a.jsx)(p.A,{className:"h-6 w-6 sm:h-8 sm:w-8 animate-spin text-muted-foreground"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Loading..."})]})})})}var F=s(70831),q=s(83013),z=s(76959),B=s(19616),G=s(63482),Q=s(80644),R=s(51920),W=s(12543),V=s(19968),$=s(37648);function Z(e){let{scheduledLeads:t,loading:s}=e,[l,i]=(0,r.useState)(new Date),n=(0,r.useMemo)(()=>{let e=new Date;return Array.from({length:14},(t,s)=>(0,F.f)(e,s))},[]),d=(0,r.useMemo)(()=>{let e=new Map;return t.forEach(t=>{if(t.scheduledAppointmentTime){let s=t.scheduledAppointmentTime.toDate(),a=(0,q.GP)(s,"yyyy-MM-dd");e.has(a)||e.set(a,[]);let r=e.get(a);r&&r.push(t)}}),e.forEach(e=>{e.sort((e,t)=>{var s,a;return((null==(s=e.scheduledAppointmentTime)?void 0:s.toDate().getTime())||0)-((null==(a=t.scheduledAppointmentTime)?void 0:a.toDate().getTime())||0)})}),e},[t]),c=(0,q.GP)(l,"yyyy-MM-dd"),m=d.get(c)||[],u=!(0,z.r)(l,n[0]),p=!(0,z.r)(l,n[n.length-1]);return s?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(R.A,{className:"h-6 w-6 sm:h-8 sm:w-8 animate-pulse text-primary mx-auto mb-2 premium:text-premium-teal premium:nav-icon premium:icon-glow-teal premium:icon-pulse"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading calendar..."})]})}):(0,a.jsxs)("div",{className:"flex flex-col h-full min-h-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2 p-2 bg-muted/30 rounded-lg shrink-0",children:[(0,a.jsx)(b.$,{variant:"ghost",size:"sm",onClick:()=>{let e=n.findIndex(e=>(0,z.r)(e,l));e>0&&i(n[e-1])},disabled:!u,className:"h-6 w-6 p-0 sm:h-8 sm:w-8 premium:hover:bg-premium-glass/50 premium:hover:glow-premium transition-all duration-300",children:(0,a.jsx)(W.A,{className:"h-3 w-3 sm:h-4 sm:w-4 premium:nav-icon premium:icon-glow-purple"})}),(0,a.jsxs)("div",{className:"text-center min-w-0",children:[(0,a.jsx)("h3",{className:"font-semibold text-sm sm:text-base truncate",children:(0,B.c)(l)?"Today":(0,q.GP)(l,"EEEE")}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,q.GP)(l,"MMM d, yyyy")})]}),(0,a.jsx)(b.$,{variant:"ghost",size:"sm",onClick:()=>{let e=n.findIndex(e=>(0,z.r)(e,l));e<n.length-1&&i(n[e+1])},disabled:!p,className:"h-6 w-6 p-0 sm:h-8 sm:w-8 premium:hover:bg-premium-glass/50 premium:hover:glow-premium transition-all duration-300",children:(0,a.jsx)(V.A,{className:"h-3 w-3 sm:h-4 sm:w-4 premium:nav-icon premium:icon-glow-purple"})})]}),(0,a.jsx)("div",{className:"mb-2 shrink-0",children:(0,a.jsx)(U.F,{className:"w-full whitespace-nowrap",children:(0,a.jsx)("div",{className:"flex space-x-1 pb-2",children:n.map(e=>{var t;let s=(0,q.GP)(e,"yyyy-MM-dd"),r=(null==(t=d.get(s))?void 0:t.length)||0,n=(0,z.r)(e,l),o=(0,G.Y)(e,(0,Q.o)(new Date))&&!(0,B.c)(e);return(0,a.jsxs)(b.$,{variant:n?"default":"outline",size:"sm",onClick:()=>i(e),className:"\n                    flex-shrink-0 flex flex-col items-center p-1.5 h-auto min-w-[45px] text-xs\n                    ".concat(o?"opacity-60":"","\n                    ").concat(n?"ring-2 ring-primary ring-offset-1":"","\n                  "),children:[(0,a.jsx)("span",{className:"font-medium leading-tight",children:(0,B.c)(e)?"Today":(0,q.GP)(e,"EEE")}),(0,a.jsx)("span",{className:"font-bold leading-tight",children:(0,q.GP)(e,"d")}),r>0&&(0,a.jsx)(j.E,{variant:"secondary",className:"text-xs px-1 py-0 h-3 min-w-[12px] mt-0.5",children:r})]},s)})})})}),(0,a.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:0===m.length?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)($.A,{className:"h-6 w-6 sm:h-8 sm:w-8 text-muted-foreground mx-auto mb-2 premium:text-premium-teal premium:nav-icon premium:icon-glow-teal"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["No appointments for ",(0,q.GP)(l,"MMM d")]})]})}):(0,a.jsx)(U.F,{className:"h-full pr-1",children:(0,a.jsx)("div",{className:"space-y-2",children:m.map(e=>(0,a.jsxs)("div",{className:"border-l-2 border-primary/20 pl-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 mb-1",children:[(0,a.jsx)($.A,{className:"h-3 w-3 text-muted-foreground premium:text-premium-teal premium:nav-icon premium:icon-glow-teal"}),(0,a.jsx)("span",{className:"text-xs font-medium text-muted-foreground",children:e.scheduledAppointmentTime&&(0,q.GP)(e.scheduledAppointmentTime.toDate(),"h:mm a")})]}),(0,a.jsx)(o.A,{lead:e,context:"queue-scheduled"})]},e.id))})})})]})}var J=s(17313),K=s(60960),Y=s(763);function X(e){if(!e||"string"!=typeof e)return null;let t=new Date(e);if(!isNaN(t.getTime()))return t;let s=e.match(/(\w+\s\d{1,2},\s\d{4})\s(?:at)\s(\d{1,2}:\d{2}:\d{2}\s[AP]M)/i);if(s){let e=s[1],a=s[2];if(!isNaN((t=new Date("".concat(e," ").concat(a))).getTime()))return t}return null}function H(){let{user:e}=(0,l.A)(),{toast:t}=(0,i.dj)(),[s,m]=(0,r.useState)([]),[u,h]=(0,r.useState)([]),[x,f]=(0,r.useState)(!0),[g,v]=(0,r.useState)(!0),[w,b]=(0,r.useState)(new Set),[N,j]=(0,r.useState)([]),[y,k]=(0,r.useState)(!0),[A,C]=(0,r.useState)(new Set);return(0,r.useEffect)(()=>{if(!e||!e.teamId){f(!1),m([]);return}f(!0);let s=(0,d.query)((0,d.collection)(n.db,"leads"),(0,d.where)("teamId","==",e.teamId),(0,d.where)("status","==","waiting_assignment"),(0,d.My)("createdAt","asc")),a=(0,d.aQ)(s,e=>{m(e.docs.map(e=>{let t=e.data(),s=null;if(t.submissionTime){if(t.submissionTime instanceof d.Dc)s=t.submissionTime;else if("string"==typeof t.submissionTime){let e=X(t.submissionTime);e&&(s=d.Dc.fromDate(e))}}else t.createdAt instanceof d.Dc&&(s=t.createdAt);return{id:e.id,customerName:t.clientName||t.customerName||"Unknown Customer",customerPhone:t.phone||t.customerPhone||"N/A",address:t.address,status:t.status,teamId:t.teamId,dispatchType:t.type||t.dispatchType||"immediate",assignedCloserId:t.assignedCloserId||t.assignedCloser||null,assignedCloserName:t.assignedCloserName||null,createdAt:s,updatedAt:t.updatedAt instanceof d.Dc?t.updatedAt:(0,d.serverTimestamp)(),dispositionNotes:t.dispositionNotes||"",scheduledAppointmentTime:t.scheduledAppointmentTime instanceof d.Dc?t.scheduledAppointmentTime:t.scheduledTime instanceof d.Dc?t.scheduledTime:null,setterId:t.setterId||null,setterName:t.setterName||null,setterLocation:t.setterLocation||null,setterVerified:t.setterVerified||!1,verifiedAt:t.verifiedAt||null,verifiedBy:t.verifiedBy||null,photoUrls:t.photoUrls||[]}}).filter(e=>!e.assignedCloserId)),f(!1)},e=>{t({title:"Error",description:"Failed to load waiting leads. Please refresh the page.",variant:"destructive"}),f(!1)});return()=>a()},[e,t]),(0,r.useEffect)(()=>{if(!e||!e.teamId){v(!1),h([]);return}v(!0);let s=(0,d.query)((0,d.collection)(n.db,"leads"),(0,d.where)("teamId","==",e.teamId),(0,d.where)("status","in",["rescheduled","scheduled"]),(0,d.My)("scheduledAppointmentTime","asc")),a=(0,d.aQ)(s,async e=>{h(e.docs.map(e=>{let t=e.data(),s=null;if(t.submissionTime){if(t.submissionTime instanceof d.Dc)s=t.submissionTime;else if("string"==typeof t.submissionTime){let e=X(t.submissionTime);e&&(s=d.Dc.fromDate(e))}}else t.createdAt instanceof d.Dc&&(s=t.createdAt);return{id:e.id,customerName:t.clientName||t.customerName||"Unknown Customer",customerPhone:t.phone||t.customerPhone||"N/A",address:t.address,status:t.status,teamId:t.teamId,dispatchType:t.type||t.dispatchType||"immediate",assignedCloserId:t.assignedCloserId||t.assignedCloser||null,assignedCloserName:t.assignedCloserName||null,createdAt:s,updatedAt:t.updatedAt instanceof d.Dc?t.updatedAt:(0,d.serverTimestamp)(),dispositionNotes:t.dispositionNotes||"",scheduledAppointmentTime:t.scheduledAppointmentTime instanceof d.Dc?t.scheduledAppointmentTime:t.scheduledTime instanceof d.Dc?t.scheduledTime:null,setterId:t.setterId||null,setterName:t.setterName||null,setterLocation:t.setterLocation||null,photoUrls:t.photoUrls||[]}})),v(!1);let s=new Date,a=(0,d.wP)(n.db),r=(0,d.wP)(n.db),l=0,i=0;if(e.docs.forEach(e=>{let t={id:e.id,...e.data()},o=e.data().scheduledAppointmentTime;if(o instanceof d.Dc&&("rescheduled"===t.status||"scheduled"===t.status)&&!w.has(t.id)){let e=o.toDate(),c=e.getTime()-s.getTime(),m=s.getTime()-e.getTime();if(m>=6e5&&!t.setterVerified){let e=(0,d.doc)(n.db,"leads",t.id);r.update(e,{status:"canceled",dispositionNotes:"Automatically canceled - not verified within 10 minutes of scheduled time",updatedAt:(0,d.serverTimestamp)()}),b(e=>new Set(e).add(t.id)),i++}else if(m>=9e5){let e=(0,d.doc)(n.db,"leads",t.id);r.update(e,{status:"expired",dispositionNotes:"Appointment expired - 15 minutes past scheduled time",updatedAt:(0,d.serverTimestamp)()}),b(e=>new Set(e).add(t.id)),i++}else if(c<=27e5&&!0===t.setterVerified){let e=(0,d.doc)(n.db,"leads",t.id);a.update(e,{status:"waiting_assignment",updatedAt:(0,d.serverTimestamp)()}),b(e=>new Set(e).add(t.id)),l++}}}),i>0)try{await r.commit(),t({title:"Unverified Leads Removed",description:"".concat(i," unverified lead(s) past their scheduled time were automatically canceled."),variant:"destructive"})}catch(e){console.error("Error removing unverified leads:",e),t({title:"Removal Failed",description:"Could not remove unverified leads automatically.",variant:"destructive"})}if(l>0)try{await a.commit(),t({title:"Verified Leads Updated",description:"".concat(l," verified lead(s) moved to waiting list for assignment.")})}catch(r){t({title:"Update Failed",description:"Could not move verified leads automatically.",variant:"destructive"});let a=e.docs.filter(e=>{let t=e.data(),a=t.scheduledAppointmentTime;return a instanceof d.Dc&&("rescheduled"===t.status||"scheduled"===t.status)&&a.toDate().getTime()-s.getTime()<=27e5&&!0===t.setterVerified&&w.has(e.id)}).map(e=>e.id);b(e=>{let t=new Set(e);return a.forEach(e=>t.delete(e)),t})}},e=>{t({title:"Error",description:"Failed to load scheduled leads. Please refresh the page.",variant:"destructive"}),v(!1)});return()=>a()},[e,t,w]),(0,r.useEffect)(()=>{if(!(null==e?void 0:e.teamId)){C(new Set),k(!1);return}k(!0);let t=(0,d.query)((0,d.collection)(n.db,"leads"),(0,d.where)("teamId","==",e.teamId),(0,d.where)("status","in",["waiting_assignment","scheduled","accepted","in_process"])),s=(0,d.aQ)(t,e=>{let t=new Set;e.forEach(e=>{let s=e.data();s.assignedCloserId&&t.add(s.assignedCloserId)}),C(t)},e=>{console.error("Failed to load assigned closers for auto-assignment:",e)});return()=>s()},[null==e?void 0:e.teamId]),(0,r.useEffect)(()=>{if(!(null==e?void 0:e.teamId)){j([]),k(!1);return}let t=(0,d.query)((0,d.collection)(n.db,"closers"),(0,d.where)("teamId","==",e.teamId),(0,d.where)("status","==","On Duty"),(0,d.My)("name","asc")),s=(0,d.aQ)(t,e=>{j(e.docs.map(e=>{let t=e.data();return{uid:e.id,name:t.name,status:t.status,teamId:t.teamId,role:t.role,avatarUrl:t.avatarUrl,phone:t.phone,lineupOrder:t.lineupOrder}}).filter(e=>!A.has(e.uid)).map((e,t)=>({...e,lineupOrder:"number"==typeof e.lineupOrder?e.lineupOrder:(t+1)*1e5})).sort((e,t)=>{var s,a;let r=null!=(s=e.lineupOrder)?s:((e.lineupOrder||0)+1)*1e5,l=null!=(a=t.lineupOrder)?a:((t.lineupOrder||0)+1)*1e5;return r!==l?r-l:e.name.localeCompare(t.name)})),k(!1)},e=>{console.error("Failed to load available closers for auto-assignment:",e),j([]),k(!1)});return()=>s()},[null==e?void 0:e.teamId,A]),(0,r.useEffect)(()=>{if(x||y||!(null==e?void 0:e.teamId)||0===s.length||0===N.length)return;let a=setTimeout(async()=>{try{let e=(0,d.wP)(n.db),a=0,r=[...s].filter(e=>!e.assignedCloserId&&"waiting_assignment"===e.status).sort((e,t)=>e.createdAt&&t.createdAt?e.createdAt.toMillis()-t.createdAt.toMillis():0),l=Math.min(r.length,N.length);for(let t=0;t<l;t++){let s=r[t],l=N[t];if(s&&l){let t=(0,d.doc)(n.db,"leads",s.id);e.update(t,{status:"waiting_assignment",assignedCloserId:l.uid,assignedCloserName:l.name,updatedAt:(0,d.serverTimestamp)()}),a++}}a>0&&(await e.commit(),t({title:"Leads Assigned",description:"".concat(a," lead(s) automatically assigned to available closers.")}))}catch(e){console.error("Failed to auto-assign leads:",e),t({title:"Assignment Failed",description:"Could not automatically assign leads to closers.",variant:"destructive"})}},1e3);return()=>clearTimeout(a)},[s,N,x,y,null==e?void 0:e.teamId,t]),(0,a.jsxs)(c.Zp,{className:"dashboard-card h-full flex flex-col bg-white/95 dark:bg-transparent premium:bg-transparent shadow-lg hover:shadow-xl transition-all duration-200 border border-gray-200 dark:border-0 premium:border-0 ring-1 ring-white/5 dark:ring-slate-800/20 dark:card-glass dark:glow-turquoise premium:card-glass premium:glow-premium",children:[(0,a.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2 px-3 sm:px-6 pt-3 sm:pt-6 bg-transparent shrink-0",children:[(0,a.jsxs)(c.ZB,{className:"text-lg sm:text-xl lg:text-2xl font-bold font-headline flex items-center text-slate-900 dark:text-slate-100 premium:text-glow",children:[(0,a.jsx)("div",{className:"p-1.5 sm:p-2 bg-transparent rounded-lg mr-2 sm:mr-3 dark:glow-turquoise premium:glow-premium premium:icon-hover-glow transition-all duration-300",children:(0,a.jsx)(K.A,{className:"h-4 w-4 sm:h-5 sm:w-5 lg:h-6 lg:w-6 text-blue-600 dark:text-blue-400 premium:text-premium-purple premium:nav-icon premium:icon-glow-purple transition-all duration-300"})}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-sm sm:text-base lg:text-xl",children:"Lead Queues"}),(0,a.jsx)("span",{className:"text-xs sm:text-sm font-normal text-muted-foreground premium:text-premium-teal",children:"Waiting & scheduled leads"})]})]}),(x||g)&&(0,a.jsx)(p.A,{className:"h-4 w-4 sm:h-5 sm:w-5 animate-spin text-muted-foreground premium:text-premium-teal premium:nav-icon premium:icon-glow-teal"})]}),(0,a.jsx)(c.Wu,{className:"flex-grow overflow-hidden px-2 sm:px-4 lg:px-6 pb-2 sm:pb-4 lg:pb-6 bg-transparent",children:(0,a.jsxs)(J.tU,{defaultValue:"waiting",className:"flex flex-col h-full",children:[(0,a.jsxs)(J.j7,{className:"grid w-full grid-cols-2 mb-2 sm:mb-4 h-9 sm:h-10 lg:h-11 bg-muted/30 dark:bg-muted/30 rounded-lg p-1 premium:border premium:border-premium-glow shrink-0",children:[(0,a.jsxs)(J.Xi,{value:"waiting",className:"h-7 sm:h-8 lg:h-9 text-xs sm:text-sm lg:text-base font-medium rounded-md transition-all bg-transparent hover:bg-white/20 data-[state=active]:bg-white data-[state=active]:text-slate-900 data-[state=active]:shadow-sm dark:data-[state=active]:bg-slate-700 dark:data-[state=active]:text-white premium:data-[state=active]:bg-gradient-to-r premium:data-[state=active]:from-premium-purple/20 premium:data-[state=active]:to-premium-teal/10 premium:data-[state=active]:border premium:data-[state=active]:border-premium-glow premium:data-[state=active]:glow-premium",children:[(0,a.jsx)(K.A,{className:"mr-1 sm:mr-2 h-3 w-3 sm:h-4 sm:w-4 lg:h-5 lg:w-5 premium:nav-icon premium:icon-glow-purple transition-all duration-300"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Waiting List"}),(0,a.jsx)("span",{className:"sm:hidden",children:"Waiting"})]}),(0,a.jsxs)(J.Xi,{value:"scheduled",className:"h-7 sm:h-8 lg:h-9 text-xs sm:text-sm lg:text-base font-medium rounded-md transition-all bg-transparent hover:bg-white/20 data-[state=active]:bg-white data-[state=active]:text-slate-900 data-[state=active]:shadow-sm dark:data-[state=active]:bg-slate-700 dark:data-[state=active]:text-white premium:data-[state=active]:bg-gradient-to-r premium:data-[state=active]:from-premium-teal/20 premium:data-[state=active]:to-premium-purple/10 premium:data-[state=active]:border premium:data-[state=active]:border-premium-glow premium:data-[state=active]:glow-premium",children:[(0,a.jsx)(Y.A,{className:"mr-1 sm:mr-2 h-3 w-3 sm:h-4 sm:w-4 lg:h-5 lg:w-5 premium:nav-icon premium:icon-glow-teal transition-all duration-300"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Scheduled"}),(0,a.jsx)("span",{className:"sm:hidden",children:"Scheduled"})]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,a.jsx)(J.av,{value:"waiting",className:"h-full mt-0 data-[state=inactive]:hidden",children:x?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(p.A,{className:"h-6 w-6 sm:h-8 sm:w-8 animate-spin text-primary mx-auto mb-3 premium:text-premium-purple premium:nav-icon premium:icon-glow-purple premium:icon-pulse"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading waiting leads..."})]})}):0===s.length?(0,a.jsxs)("div",{className:"flex h-full flex-col items-center justify-center text-center py-8",children:[(0,a.jsx)("div",{className:"p-3 bg-transparent rounded-full mb-3 premium:glow-premium transition-all duration-300",children:(0,a.jsx)(K.A,{className:"h-6 w-6 sm:h-8 sm:w-8 text-muted-foreground premium:text-premium-purple premium:nav-icon premium:icon-glow-purple"})}),(0,a.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-foreground mb-2 premium:text-glow",children:"Queue Empty"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs sm:text-sm max-w-xs",children:"No leads are currently waiting for assignment. New leads will appear here automatically."})]}):(0,a.jsx)(U.F,{className:"h-full",children:(0,a.jsx)("div",{className:"space-y-3 pr-2",children:s.map(e=>(0,a.jsx)(o.A,{lead:e,context:"queue-waiting"},e.id))})})}),(0,a.jsx)(J.av,{value:"scheduled",className:"h-full mt-0 data-[state=inactive]:hidden",children:(0,a.jsx)(Z,{scheduledLeads:u,loading:g})})]})]})})]})}function ee(){let{user:e}=(0,l.A)();return e?(0,a.jsx)("div",{className:"min-h-[calc(100vh-4rem)] p-4 md:p-6",children:(0,a.jsxs)("div",{className:"dashboard-page-grid grid grid-cols-1 gap-4 md:gap-6 lg:grid-cols-5 lg:h-[calc(100vh-12rem)]",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 flex flex-col gap-4 md:gap-6 min-h-0",children:[(0,a.jsx)("div",{className:"mobile-75vh lg:flex-1 lg:min-h-0","data-dashboard-card":!0,children:(0,a.jsx)(L,{})}),(0,a.jsx)("div",{className:"mobile-75vh lg:flex-1 lg:min-h-0","data-dashboard-card":!0,children:(0,a.jsx)(M,{})})]}),(0,a.jsx)("div",{className:"lg:col-span-3 flex flex-col min-h-0",children:(0,a.jsx)("div",{className:"mobile-75vh lg:h-full","data-dashboard-card":!0,children:(0,a.jsx)(H,{})})})]})}):null}},17313:(e,t,s)=>{"use strict";s.d(t,{Xi:()=>o,av:()=>c,j7:()=>d,tU:()=>n});var a=s(95155),r=s(12115),l=s(60704),i=s(59434);let n=l.bL,d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.B8,{ref:t,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r})});d.displayName=l.B8.displayName;let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.l9,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...r})});o.displayName=l.l9.displayName;let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.UC,{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});c.displayName=l.UC.displayName},80333:(e,t,s)=>{"use strict";s.d(t,{d:()=>n});var a=s(95155),r=s(12115),l=s(4884),i=s(59434);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.bL,{className:(0,i.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...r,ref:t,children:(0,a.jsx)(l.zi,{className:(0,i.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});n.displayName=l.bL.displayName},91394:(e,t,s)=>{"use strict";s.d(t,{BK:()=>d,eu:()=>n,q5:()=>o});var a=s(95155),r=s(12115),l=s(54011),i=s(59434);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.bL,{ref:t,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...r})});n.displayName=l.bL.displayName;let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l._V,{ref:t,className:(0,i.cn)("aspect-square h-full w-full",s),...r})});d.displayName=l._V.displayName;let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.H4,{ref:t,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...r})});o.displayName=l.H4.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,3644,4763,4277,5296,9233,9196,4547,1859,8104,3450,7954,2502,3849,618,7313,8622,5341,5146,8441,1684,7358],()=>t(5497)),_N_E=e.O()}]);