(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1064],{6101:(e,t,r)=>{"use strict";r.d(t,{s:()=>l,t:()=>s});var a=r(12115);function n(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function s(...e){return t=>{let r=!1,a=e.map(e=>{let a=n(e,t);return r||"function"!=typeof a||(r=!0),a});if(r)return()=>{for(let t=0;t<a.length;t++){let r=a[t];"function"==typeof r?r():n(e[t],null)}}}}function l(...e){return a.useCallback(s(...e),e)}},30285:(e,t,r)=>{"use strict";r.d(t,{$:()=>d,r:()=>i});var a=r(95155),n=r(12115),s=r(99708),l=r(74466),o=r(59434);let i=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 touch-manipulation select-none",{variants:{variant:{default:"text-primary-foreground bg-gradient-to-r from-[hsl(var(--primary-gradient-from))] to-[hsl(var(--primary-gradient-to))] hover:from-[hsl(var(--primary-gradient-to))] hover:to-[hsl(var(--primary-gradient-from))] shadow-md hover:shadow-lg active:scale-95",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-md hover:shadow-lg active:scale-95",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground shadow-sm hover:shadow-md active:scale-95",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm hover:shadow-md active:scale-95",ghost:"hover:bg-accent hover:text-accent-foreground active:scale-95",link:"text-primary underline-offset-4 hover:underline","primary-solid":"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md hover:shadow-lg active:scale-95"},size:{default:"h-10 px-4 py-2 min-h-touch mobile:h-12 mobile:px-6 mobile:text-base",sm:"h-9 rounded-md px-3 min-h-touch mobile:h-10 mobile:px-4",lg:"h-11 rounded-md px-8 min-h-touch mobile:h-14 mobile:px-10 mobile:text-lg",icon:"h-10 w-10 min-h-touch min-w-touch mobile:h-12 mobile:w-12"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,t)=>{let{className:r,variant:n,size:l,asChild:d=!1,...c}=e,u=d?s.DX:"button";return(0,a.jsx)(u,{className:(0,o.cn)(i({variant:n,size:l,className:r})),ref:t,...c})});d.displayName="Button"},56104:(e,t,r)=>{"use strict";r.d(t,{EF:()=>g,IG:()=>u,V$:()=>h,db:()=>c,j2:()=>d,yA:()=>i});var a=r(23915),n=r(93004),s=r(35317),l=r(90858),o=r(81427);let i=(0,a.Dk)().length?(0,a.Sx)():(0,a.Wp)({apiKey:"AIzaSyBc3jmFE6dRXBApmWD9Jg2PO86suqGgaZw",authDomain:"leadflow-4lvrr.firebaseapp.com",projectId:"leadflow-4lvrr",storageBucket:"leadflow-4lvrr.firebasestorage.app",messagingSenderId:"13877630896",appId:"1:13877630896:web:ab7d2717024960ec36e875",measurementId:"G-KDEF2C21SH"}),d=(0,n.xI)(i),c=(0,s.aU)(i),u=(0,l.c7)(i),m=(0,o.Uz)(i),g=(0,o.Qg)(m,"acceptJob"),h=(0,o.Qg)(m,"inviteUser");(0,o.Qg)(m,"updateAdminRoles"),(0,o.Qg)(m,"getTeamStats"),(0,o.Qg)(m,"getDetailedAnalytics"),(0,o.Qg)(m,"generateAnalyticsReport")},59434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>s});var a=r(52596),n=r(39688);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.QP)((0,a.$)(t))}},62722:(e,t,r)=>{Promise.resolve().then(r.bind(r,64394))},64394:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var a=r(95155),n=r(12115),s=r(30285),l=r(66695),o=r(98030);function i(){let{user:e}=(0,o.A)(),[t,i]=(0,n.useState)(!1),[d,c]=(0,n.useState)(""),[u,m]=(0,n.useState)(!1),g=e&&("manager"===e.role||"admin"===e.role);(0,n.useEffect)(()=>{let e=async()=>{try{let{db:e}=await Promise.resolve().then(r.bind(r,56104));e&&m(!0)}catch(e){console.error("Firebase not ready:",e),c("❌ Firebase connection failed. Please refresh the page.")}};g&&e()},[g]);let h=async()=>{if(!g)return void c("❌ Access denied. Admin/Manager role required.");i(!0),c("Starting Tony Tiger lead fix...");try{c("Loading Firebase...");let{db:a}=await Promise.resolve().then(r.bind(r,56104)),{collection:n,query:s,where:l,getDocs:o,doc:i,updateDoc:d,serverTimestamp:u}=await Promise.resolve().then(r.bind(r,35317));c("✅ Firebase loaded. Searching for Tony Tiger lead...");let m=s(n(a,"leads"),l("customerName","==","Tony Tiger")),g=await o(m);if(g.empty&&(c("No customer named Tony Tiger found. Searching assigned closers..."),m=s(n(a,"leads"),l("assignedCloserName","==","Tony Tiger")),g=await o(m)),g.empty){c("❌ No Tony Tiger lead found. Let me search all leads...");let e=s(n(a,"leads")),t=await o(e),r="Found ".concat(t.size," total leads:\n\n"),l=!1;t.forEach(e=>{let t=e.data(),a=t.customerName||"No Name",n=t.assignedCloserName||"Unassigned";(a.toLowerCase().includes("tony")||n.toLowerCase().includes("tony")||a.toLowerCase().includes("tiger")||n.toLowerCase().includes("tiger"))&&(r+="\uD83C\uDFAF MATCH: ".concat(e.id,"\n"),r+="   Customer: ".concat(a,"\n"),r+="   Assigned: ".concat(n,"\n"),r+="   Status: ".concat(t.status,"\n\n"),l=!0)}),l||(r+="\n❌ No leads found containing 'Tony' or 'Tiger'"),c(r);return}let h="Found ".concat(g.size," Tony Tiger lead(s):\n\n"),f=0;for(let r of g.docs){var e,t;let n=r.data();h+="\uD83D\uDCCB Lead ID: ".concat(r.id,"\n"),h+="\uD83D\uDC64 Customer: ".concat(n.customerName,"\n"),h+="\uD83C\uDFAF Assigned to: ".concat(n.assignedCloserName||"Unassigned","\n"),h+="\uD83D\uDCCA Status: ".concat(n.status,"\n"),h+="\uD83D\uDD52 Created: ".concat((null==(t=n.createdAt)||null==(e=t.toDate)?void 0:e.call(t))||"Unknown","\n"),h+="---\n","scheduled"===n.status?(h+="\uD83D\uDD04 Updating ".concat(r.id,' from "scheduled" to "rescheduled"...\n'),await d(i(a,"leads",r.id),{status:"rescheduled",updatedAt:u(),statusChangeReason:"Fixed icon color - lead was reassigned so should show rescheduled"}),h+="✅ Updated successfully!\n",f++):"rescheduled"===n.status?h+='✅ Already marked as "rescheduled"\n':h+='ℹ️ Status is "'.concat(n.status,'" - no update needed\n'),h+="\n"}f>0?(h+="\n\uD83C\uDF89 SUCCESS! Updated ".concat(f,' lead(s) to "rescheduled".\n'),h+="\uD83C\uDFA8 Tony Tiger's lead will now show a PURPLE rescheduled icon.\n",h+="\uD83D\uDD04 Refresh the dashboard to see changes."):h+="\n\uD83D\uDCDD No leads needed updating.",c(h)}catch(r){let e=r instanceof Error?r.message:"Unknown error",t=r instanceof Error?r:String(r);c("❌ Error: ".concat(e,"\n\nFull error: ").concat(JSON.stringify(t,null,2)))}finally{i(!1)}};return e?g?(0,a.jsx)("div",{className:"container mx-auto p-6",children:(0,a.jsxs)(l.Zp,{className:"max-w-4xl mx-auto",children:[(0,a.jsx)(l.aR,{children:(0,a.jsx)(l.ZB,{children:"Tony Tiger Lead Status Fix"})}),(0,a.jsxs)(l.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:"What this tool does:"})}),(0,a.jsxs)("ul",{className:"list-disc ml-5 mt-2 space-y-1",children:[(0,a.jsx)("li",{children:"Finds Tony Tiger's lead in the database"}),(0,a.jsx)("li",{children:'Changes status from "scheduled" to "rescheduled"'}),(0,a.jsxs)("li",{children:["This makes the lead show a ",(0,a.jsx)("span",{className:"text-purple-600 font-semibold",children:"PURPLE"})," rescheduled icon instead of blue"]}),(0,a.jsx)("li",{children:"Only works for Manager/Admin users"})]})]}),!u&&g&&(0,a.jsx)("div",{className:"text-amber-600 text-sm",children:"⚠️ Firebase is still loading..."}),(0,a.jsx)(s.$,{onClick:h,disabled:t||!u,className:"w-full",children:t?"Working...":"Find and Fix Tony Tiger Lead"}),d&&(0,a.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-900 rounded-lg border",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Results:"}),(0,a.jsx)("pre",{className:"text-sm whitespace-pre-wrap font-mono overflow-x-auto",children:d})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 border-t pt-4",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Alternative method:"})," You can also run the browser console script:"]}),(0,a.jsxs)("ol",{className:"list-decimal ml-5 mt-1 space-y-1",children:[(0,a.jsx)("li",{children:"Go to the dashboard page"}),(0,a.jsx)("li",{children:"Open Developer Tools (F12) → Console tab"}),(0,a.jsxs)("li",{children:["Copy and paste the script from ",(0,a.jsx)("code",{children:"/scripts/browser-fix-tony-tiger.js"})]})]})]})]})]})}):(0,a.jsx)("div",{className:"container mx-auto p-6",children:(0,a.jsxs)(l.Zp,{className:"max-w-2xl mx-auto",children:[(0,a.jsx)(l.aR,{children:(0,a.jsx)(l.ZB,{className:"text-red-600",children:"Access Denied"})}),(0,a.jsxs)(l.Wu,{children:[(0,a.jsx)("p",{children:"This tool requires Manager or Admin role."}),(0,a.jsxs)("p",{children:["Your current role: ",e.role]})]})]})}):(0,a.jsx)("div",{className:"container mx-auto p-6",children:(0,a.jsx)(l.Zp,{className:"max-w-2xl mx-auto",children:(0,a.jsx)(l.Wu,{className:"p-6",children:(0,a.jsx)("div",{className:"text-center",children:"Loading..."})})})})}},66695:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>i,Zp:()=>l,aR:()=>o,wL:()=>u});var a=r(95155),n=r(12115),s=r(59434);let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,"data-card":"true",className:(0,s.cn)("rounded-2xl overflow-hidden border border-slate-200 bg-white text-card-foreground","shadow-lg shadow-slate-200/50 hover:shadow-xl hover:shadow-slate-300/50","transition-all duration-200 ease-in-out","mobile:rounded-xl mobile:mx-2 mobile:shadow-md","mobile:border-slate-300/50",r),...n})});l.displayName="Card";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6","mobile:p-4 mobile:space-y-1",r),...n})});o.displayName="CardHeader";let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("h3",{ref:t,className:(0,s.cn)("text-3xl font-bold font-headline leading-tight tracking-tight text-center","mobile:text-xl mobile:leading-snug","tablet:text-2xl",r),...n})});i.displayName="CardTitle";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("p",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground text-center","mobile:text-xs mobile:leading-relaxed",r),...n})});d.displayName="CardDescription";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",r),...n})});c.displayName="CardContent";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",r),...n})});u.displayName="CardFooter"},74466:(e,t,r)=>{"use strict";r.d(t,{F:()=>l});var a=r(52596);let n=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,s=a.$,l=(e,t)=>r=>{var a;if((null==t?void 0:t.variants)==null)return s(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:l,defaultVariants:o}=t,i=Object.keys(l).map(e=>{let t=null==r?void 0:r[e],a=null==o?void 0:o[e];if(null===t)return null;let s=n(t)||n(a);return l[e][s]}),d=r&&Object.entries(r).reduce((e,t)=>{let[r,a]=t;return void 0===a||(e[r]=a),e},{});return s(e,i,null==t||null==(a=t.compoundVariants)?void 0:a.reduce((e,t)=>{let{class:r,className:a,...n}=t;return Object.entries(n).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...o,...d}[t]):({...o,...d})[t]===r})?[...e,r,a]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}},98030:(e,t,r)=>{"use strict";r.d(t,{A:()=>m,AuthProvider:()=>u});var a=r(95155),n=r(93004),s=r(35317),l=r(35695),o=r(12115),i=r(56104),d=r(50172);let c=(0,o.createContext)(void 0),u=e=>{let{children:t}=e,[r,u]=(0,o.useState)(null),[m,g]=(0,o.useState)(null),[h,f]=(0,o.useState)(!0),[p,x]=(0,o.useState)(!1),v=(0,l.useRouter)(),b=(0,l.usePathname)(),y=(0,o.useRef)({isNavigating:!1});(0,o.useEffect)(()=>{console.log("\uD83D\uDD25 Setting up Firebase auth listener");let e=(0,n.hg)(i.j2,async e=>{if(console.log("\uD83D\uDD25 Firebase auth state changed:",!!e,"uid:",null==e?void 0:e.uid),(null==r?void 0:r.uid)===(null==e?void 0:e.uid)&&p)return void console.log("\uD83D\uDD04 Same user, skipping update");u(e),x(!0),!e&&(g(null),f(!1),"/login"===b||y.current.isNavigating||(y.current.isNavigating=!0,console.log("\uD83D\uDEAA Redirecting to login"),v.replace("/login"),setTimeout(()=>{y.current.isNavigating=!1},1e3)))});return()=>{console.log("\uD83D\uDD25 Cleaning up Firebase auth listener"),e()}},[]),(0,o.useEffect)(()=>{let e;if(r&&p){console.log("\uD83D\uDC64 Setting up user document listener for:",r.uid);let t=(0,s.doc)(i.db,"users",r.uid);e=(0,s.aQ)(t,async e=>{if(console.log("\uD83D\uDCC4 User document snapshot received, exists:",e.exists()),e.exists()){let t={uid:r.uid,...e.data()};g(t),f(!1),console.log("✅ User data loaded:",t.email,t.role),"/login"!==b||y.current.isNavigating||(y.current.isNavigating=!0,console.log("\uD83C\uDFE0 Redirecting to dashboard"),v.replace("/dashboard"),setTimeout(()=>{y.current.isNavigating=!1},1e3))}else{console.log("\uD83D\uDCDD Creating default user document");let e={uid:r.uid,email:r.email||"",displayName:r.displayName||"",role:"setter",teamId:"default",avatarUrl:r.photoURL||null,phoneNumber:r.phoneNumber||null,status:"On Duty",createdAt:new Date().toISOString()};try{await (0,s.setDoc)(t,e),g(e),f(!1),console.log("✅ Default user document created")}catch(e){console.error("❌ Failed to create user document:",e),g(null),f(!1)}}},e=>{console.error("❌ User document listener error:",e),g(null),f(!1)})}else!r&&p&&(g(null),f(!1));return()=>{e&&(console.log("\uD83E\uDDF9 Cleaning up user document listener"),e())}},[r,p,b,v]);let w=async()=>{console.log("\uD83D\uDC4B Logging out"),y.current.isNavigating=!0,f(!0);try{await (0,n.CI)(i.j2),g(null),u(null),v.replace("/login")}catch(e){console.error("❌ Logout error:",e)}finally{f(!1),setTimeout(()=>{y.current.isNavigating=!1},1e3)}};if(h&&!p)return(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-background",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)(d.A,{className:"h-12 w-12 animate-spin text-primary"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading..."})]})});let N={firebaseUser:r,user:m,loading:h,teamId:(null==m?void 0:m.teamId)||null,role:(null==m?void 0:m.role)||null,logout:w};return(0,a.jsx)(c.Provider,{value:N,children:t})},m=()=>{let e=(0,o.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},99708:(e,t,r)=>{"use strict";r.d(t,{DX:()=>o,Dc:()=>d,TL:()=>l});var a=r(12115),n=r(6101),s=r(95155);function l(e){let t=function(e){let t=a.forwardRef((e,t)=>{let{children:r,...s}=e;if(a.isValidElement(r)){var l;let e,o,i=(l=r,(o=(e=Object.getOwnPropertyDescriptor(l.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?l.ref:(o=(e=Object.getOwnPropertyDescriptor(l,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?l.props.ref:l.props.ref||l.ref),d=function(e,t){let r={...t};for(let a in t){let n=e[a],s=t[a];/^on[A-Z]/.test(a)?n&&s?r[a]=(...e)=>{let t=s(...e);return n(...e),t}:n&&(r[a]=n):"style"===a?r[a]={...n,...s}:"className"===a&&(r[a]=[n,s].filter(Boolean).join(" "))}return{...e,...r}}(s,r.props);return r.type!==a.Fragment&&(d.ref=t?(0,n.t)(t,i):i),a.cloneElement(r,d)}return a.Children.count(r)>1?a.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),r=a.forwardRef((e,r)=>{let{children:n,...l}=e,o=a.Children.toArray(n),i=o.find(c);if(i){let e=i.props.children,n=o.map(t=>t!==i?t:a.Children.count(e)>1?a.Children.only(null):a.isValidElement(e)?e.props.children:null);return(0,s.jsx)(t,{...l,ref:r,children:a.isValidElement(e)?a.cloneElement(e,void 0,n):null})}return(0,s.jsx)(t,{...l,ref:r,children:n})});return r.displayName=`${e}.Slot`,r}var o=l("Slot"),i=Symbol("radix.slottable");function d(e){let t=({children:e})=>(0,s.jsx)(s.Fragment,{children:e});return t.displayName=`${e}.Slottable`,t.__radixId=i,t}function c(e){return a.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===i}}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,3644,4763,4277,8441,1684,7358],()=>t(62722)),_N_E=e.O()}]);